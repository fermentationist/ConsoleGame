{"version":3,"file":"index.js","sources":["../lib/utils/storage.js","../lib/utils/helpers.js","../lib/utils/prefs.js","../lib/utils/customConsole/styles.js","../lib/utils/customConsole/webFonts.js","../lib/utils/customConsole/console_ransom.js","../lib/utils/customConsole/index.js","../lib/utils/dogNames.js","../lib/utils/thesaurus.js","../lib/maps/maps.js","../lib/items/itemContents.js","../rollup-plugin-item-loader:items","../lib/items/index.js","../lib/items/Item.js","../lib/maps/mapKey.js","../lib/descriptions.js","../lib/initialTimers.js","../lib/TurnDaemon.js","../lib/CommandBinder.js","../lib/Game.js","../lib/commands.js","../lib/maps/MapCell.js","../lib/index.js"],"sourcesContent":["export const initStorage = (namespace = \"ConsoleGame\") => {\n    const storageMethods = {\n        getStorage: (key) => {\n            var _a;\n            if (!key) {\n                return localStorage;\n            }\n            const stringifiedData = (_a = localStorage.getItem(`${namespace}.${key}`)) !== null && _a !== void 0 ? _a : \"null\";\n            ;\n            try {\n                return JSON.parse(stringifiedData);\n            }\n            catch (err) {\n                return stringifiedData;\n            }\n        },\n        setStorage: (key, data, merge = false) => {\n            let newState = data;\n            const previousState = storageMethods.getStorage(key);\n            if (previousState && typeof previousState === \"object\" && typeof data === \"object\" && merge) {\n                newState = Object.assign(Object.assign({}, previousState), data);\n            }\n            localStorage.setItem(`${namespace}.${key}`, JSON.stringify(newState));\n            return newState;\n        },\n        removeStorage: (key) => {\n            localStorage.removeItem(`${namespace}.${key}`);\n        }\n    };\n    return storageMethods;\n};\nconst storage = initStorage(\"ConsoleGame\");\nexport default storage;\n//# sourceMappingURL=storage.js.map","// using copy of eval function to avoid issues with Rollup (see https://rollup.docschina.org/guide/en/#avoiding-eval)\nconst eval2 = eval;\nexport const getRandomInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;\nexport const cases = (...wordArgs) => {\n    let lc, cases;\n    const casesArray = wordArgs.map((word) => {\n        lc = word.toLowerCase();\n        cases = [lc, `${lc.charAt(0).toUpperCase()}${lc.slice(1)}`, lc.toUpperCase()];\n        return word.length ? cases : \"\";\n    });\n    return casesArray.join(\",\"); // output is a single string, with variations separated by commas\n};\nexport const aliasString = (word, thesaurus, optionalString = \"\") => {\n    // thesaurus will be added to params\n    let variations = [];\n    if (thesaurus) {\n        const synonyms = (thesaurus === null || thesaurus === void 0 ? void 0 : thesaurus[word]) || [];\n        variations = synonyms.map((synonym) => cases(synonym));\n    }\n    const output = `${cases(word)}${variations.length ? \",\" + variations.join() : \"\"}${optionalString ? \",\" + optionalString : \"\"}`;\n    return output;\n};\n// deepClone is a recursive function that will clone an object, including objects with functions. It will fail if the functions are defined as declared functions or class methods. It will also fail if the object contains DOM elements, or RegExp or other objects that cannot be cloned.\nexport const deepClone = (obj, unfreeze = true) => {\n    if (typeof obj === \"function\") {\n        // for whatever reason, eval2(String(obj)) does not work for declared functions or class methods, but it does work for anonymous and arrow functions\n        const fnString = String(obj);\n        try {\n            return eval2(fnString);\n        }\n        catch (err) {\n            // serialization/deserialization of function failed, returning original function\n            return obj;\n        }\n    }\n    if (obj === null || typeof obj !== \"object\") {\n        return obj;\n    }\n    if (Array.isArray(obj)) {\n        return obj.map((item) => deepClone(item));\n    }\n    if (obj instanceof Date) {\n        return new Date(obj.getTime());\n    }\n    if (obj instanceof RegExp) {\n        return new RegExp(obj);\n    }\n    if (obj instanceof Map) {\n        const map = new Map();\n        obj.forEach((value, key) => {\n            map.set(key, deepClone(value));\n        });\n        return map;\n    }\n    if (obj instanceof Set) {\n        const set = new Set();\n        obj.forEach((value) => {\n            set.add(deepClone(value));\n        });\n        return set;\n    }\n    const clone = Object.create(Object.getPrototypeOf(obj));\n    Object.getOwnPropertyNames(obj).forEach((key) => {\n        const descriptor = Object.getOwnPropertyDescriptor(obj, key) || {};\n        if (unfreeze && descriptor.writable === false) {\n            descriptor.writable = true;\n        }\n        if (\"value\" in descriptor) {\n            try {\n                descriptor.value = deepClone(descriptor.value);\n            }\n            catch (error) {\n                // do nothing\n                // attempting to clone a getter or setter will throw an error, but we don't need to do anything about it\n            }\n        }\n        Object.defineProperty(clone, key, descriptor);\n    });\n    Object.getOwnPropertySymbols(obj).forEach((key) => {\n        const descriptor = Object.getOwnPropertyDescriptor(obj, key) || {};\n        if (descriptor.value) {\n            try {\n                descriptor.value = deepClone(descriptor.value);\n            }\n            catch (error) {\n                // do nothing\n                // attempting to clone a getter or setter will throw an error, but we don't need to do anything about it\n            }\n        }\n        Object.defineProperty(clone, key, descriptor);\n    });\n    // Object.keys(obj).forEach((key) => {\n    //   try {\n    //     clone[key] = deepClone(obj[key]);\n    //   } catch (error) {\n    //     console.error(\"error cloning key: \", key, \"error: \", error)\n    //     // do nothing\n    //     // attempting to clone a getter or setter will throw an error, but we don't need to do anything about it\n    //   }\n    // });\n    return clone;\n};\nexport function deepFreeze(obj) {\n    if (Object.isFrozen(obj) || typeof obj !== \"object\") {\n        return obj;\n    }\n    if (typeof obj === \"function\") {\n        throw \"cannot freeze a function\";\n    }\n    const normalKeys = getAllNormalKeys(obj);\n    for (const key in normalKeys) {\n        deepFreeze(obj[key]);\n    }\n    // Object.values(obj).forEach(deepFreeze);\n    return Object.freeze(obj);\n}\n// this recursive function will serialize objects with functions. It will fail if the object contains circular references, or if the functions contain references to variables outside of the object. It will also fail for references to DOM elements, or RegExp or other objects that cannot be serialized.\nexport const stringifyObjectWithFunctions = (obj, { keysToExclude = [], stringifyFunctions = true } = {}, options = { keysToExclude, stringifyFunctions }) => {\n    return JSON.stringify(obj, (key, value) => {\n        if (keysToExclude.includes(key)) {\n            return null;\n        }\n        if (value && typeof value === \"object\") {\n            return stringifyObjectWithFunctions(value, options);\n        }\n        if (typeof value === \"function\" && stringifyFunctions) {\n            return String(value);\n        }\n        return value;\n    });\n};\n// without the second argument, which is either an array of string keys or the string \"all\", this function has no way to know which strings to evaluate as functions, and which to leave as strings.\nexport const parseObjectWithFunctions = (jsonString, keysToParseAsFunctions) => {\n    return JSON.parse(jsonString, (key, value) => {\n        if (keysToParseAsFunctions === \"all\" ||\n            keysToParseAsFunctions.includes(key)) {\n            return eval2(value);\n        }\n        return value;\n    });\n};\nexport const formatList = (itemArray, disjunction = false) => {\n    const length = itemArray.length;\n    const conjunction = disjunction ? \"or\" : \"and\";\n    if (length === 0) {\n        return \"nothing\";\n    }\n    if (length === 1) {\n        return itemArray[0];\n    }\n    if (length === 2) {\n        return `${itemArray[0]} ${conjunction} ${itemArray[1]}`;\n    }\n    return `${itemArray[0]}, ${formatList(itemArray.slice(1), disjunction)}`;\n};\nexport const getAllNormalKeys = (obj) => {\n    return Object.keys(obj).filter(key => {\n        const descriptor = Object.getOwnPropertyDescriptor(obj, key) || {};\n        return !descriptor.get && !descriptor.set;\n    });\n};\nexport const cropFloorMap = (floorMap) => {\n    const top = floorMap.findIndex(row => row.some(cell => cell !== \"⬛️\")) - 1;\n    const bottom = floorMap.length - [...floorMap].reverse().findIndex(row => row.some(cell => cell !== \"⬛️\")) + 1;\n    const lefts = floorMap.map(row => {\n        const index = row.findIndex(cell => cell !== \"⬛️\");\n        return index === -1 ? row.length : index;\n    });\n    const left = Math.max(Math.min(...lefts) - 1, 0);\n    const rights = floorMap.map(row => {\n        const reverseIndex = [...row].reverse().findIndex(cell => cell !== \"⬛️\");\n        return reverseIndex === -1 ? 0 : row.length - reverseIndex;\n    });\n    const right = Math.min(Math.max(...rights) + 1, floorMap[0].length);\n    const cropped = floorMap.slice(top, bottom).map(row => row.slice(left, right));\n    return cropped;\n};\n//# sourceMappingURL=helpers.js.map","// Global preference values.\nexport let defaultFont = \"monaco\";\nexport let defaultTextColor = \"#32cd32\";\nexport let defaultFontSize = \"100%\";\nexport let prefsAreSet = Object.keys(localStorage).some((key) => {\n    return key.indexOf(\"ConsoleGame.prefs\") !== -1;\n});\nconsole.log(!prefsAreSet ? \"no user preferences detected.\" : \"user preferences applied.\");\nexport let primaryFont = localStorage.getItem(\"ConsoleGame.prefs.font\") || defaultFont;\nexport let textColor = localStorage.getItem(\"ConsoleGame.prefs.color\") || defaultTextColor;\nexport let fontSize = localStorage.getItem(\"ConsoleGame.prefs.size\") || defaultFontSize;\nexport let pStyle = `font-size:calc(1.2 *${fontSize});color:${textColor};font-family:${primaryFont};line-height:1.5;`;\n//# sourceMappingURL=prefs.js.map","import { getRandomInt } from \"../helpers\";\nimport { primaryFont, textColor, fontSize, pStyle } from \"../prefs\";\n// each style object listed here will be used to create a custom console method by customConsole.ts. They must each start with an underscore, because when rollup builds the project into a single file, the names of the style objects will polluted the global namespace. The underscore is removed when the style object is used to create a custom console method.\n// add each of the following exports to a single object, and then export that object. This is necessary because rollup will not allow you to export multiple objects from a single file. The object will be used to create the custom console methods in customConsole.ts.\nexport default {\n    error: {\n        style: `\n      font-size:calc(1.2 * ${fontSize});\n      color:red;\n      font-family:${primaryFont};\n      line-height:1.5;\n    `,\n        logType: \"error\",\n    },\n    h1: {\n        style: `\n      font-size:125%;\n      color:pink;\n      font-family:${primaryFont};\n    `,\n        logType: \"log\",\n    },\n    intro: {\n        style: `\n      font-size:calc(1.25 * ${fontSize});\n      color:orange;\n      font-family:${primaryFont};\n      padding:0 1em;\n      line-height:1.5;\n    `,\n        logType: \"log\",\n    },\n    cursive: {\n        style: `\n      font-size:calc(1.2 * ${fontSize});\n      font-family:cursive;\n      font-weight:bold;\n      color:lightgray;\n      background-color:black;\n      line-spacing:2em;\n      padding:1em;\n      margin:0 auto  0 0;\n      white-space:pre-wrap;\n      text-align:center;\n    `,\n        logType: \"log\",\n    },\n    note: {\n        style: `\n      font-size:calc(1.2 * ${fontSize});\n      font-family:courier new;\n      color:#75715E;\n      background-color:white;\n      line-spacing:2em;\n      padding:0 1em 1em 0;\n      margin:0 auto  0 0;\n      white-space:pre-wrap;\n    `,\n        logType: \"log\",\n    },\n    warning: {\n        style: `\n      font-size:calc(1.15 * ${fontSize});\n      color:orange;\n      font-family:${primaryFont};\n    `,\n        logType: \"warn\",\n    },\n    papyracy: {\n        style: `\n      font-size:calc(1.4 * ${fontSize});\n      color:beige;\n      font-family:Papyrus;\n    `,\n        logType: \"log\",\n    },\n    p: {\n        style: pStyle,\n        logType: \"log\",\n    },\n    tiny: {\n        style: `\n      font-size:calc(0.5 * ${fontSize});\n      color:#75715E;\n      font-family:${primaryFont};\n    `,\n        logType: \"log\",\n    },\n    info: {\n        style: `\n    font-size:calc(1.15*${fontSize});\n    padding:0.5em 1em 0 0.5em;\n    font-family:${primaryFont};\n  `,\n        logType: \"log\",\n    },\n    invalid: {\n        style: `\n    font-size:calc(1.2 * ${fontSize});\n    color:red;\n    font-family:${primaryFont};\n    padding:0 1em;\n  `,\n        logType: \"log\",\n    },\n    inventory: {\n        style: `\n      font-size:calc(1.2 * ${fontSize});\n      color:cyan;\n      font-family:${primaryFont};\n      padding:0 1em;\n    `,\n        logType: \"log\",\n    },\n    title: {\n        style: `\n      font-size:calc(2.5 * ${fontSize});\n      font-weight:bold;\n      color:orangered;\n      text-shadow:orange 2px 2px 5px;\n      goldenrod -2px -2px 5px;\n      font-family:Courier;\n      padding:0 1em;\n      margin:0 auto 0 35%;\n      border: 2px dashed goldenrod;\n    `,\n        logType: \"log\",\n    },\n    win: {\n        style: `\n      font-size:calc(2.5 * ${fontSize});\n      font-weight:bold;\n      color:gold;\n      text-shadow:orange 2px 2px 5px;\n      goldenrod -2px -2px 5px;\n      font-family:Courier;\n      padding:0 1em;\n      animation:flashing 0.8s infinite;\n    `,\n        logType: \"log\",\n    },\n    header: {\n        style: `\n      font-size:calc(1.25 * ${fontSize});\n      font-weight:bold;\n      color:${textColor};\n      font-family:${primaryFont};\n      padding:0 1em;\n    `,\n        logType: \"log\",\n    },\n    groupTitle: {\n        style: `\n      font-size:calc(1.25 * ${fontSize});\n      color:#75EA5B;\n      font-family:${primaryFont};\n    `,\n        logType: \"group\",\n    },\n    codeInlineBaseStyle: `\n    font-size:calc(1.15*${fontSize});\n    font-family:${primaryFont};\n    font-weight:inherit;\n    line-height:1.5;\n    padding-top:0.5em;\n  `,\n    codeInlineCodeStyle: `\n    font-family:courier;\n    font-weight:bold;\n    line-height:1.5;\n    padding-top:0.5em;\n    font-size:calc(1.35*${fontSize});\n    color:lime;\n  `,\n    getDigiStyle: () => `\n    font-family:'monaco', 'Consolas', 'Lucida Console', 'Courier New', monospace;\n    color:rgb(${255 - getRandomInt(0, 10)}, ${68 + getRandomInt(0, 10)}, ${0 + getRandomInt(0, 10)});\n    font-size:${1.5 + Math.random() / 4}em;\n    opacity:${1 - Math.random() / 2};\n  `,\n    getScreamStyle: (index) => `\n    font-family:'courier new';\n    color:rgb(${255 + getRandomInt(0, 10)}, ${33 + getRandomInt(0, 10)}, ${33 + getRandomInt(0, 10)});\n    font-size:${1.2 + index / 3}em;\n  `,\n};\n//# sourceMappingURL=styles.js.map","export default [\n    \"Arial\",\n    \"Arial Black\",\n    \"Arial Narrow\",\n    \"Arial Rounded MT Bold\",\n    \"Avant Garde\",\n    \"Calibri\",\n    \"Candara\",\n    \"Century Gothic\",\n    \"Franklin Gothic Medium\",\n    \"Futura\",\n    \"Geneva\",\n    \"Gill Sans\",\n    \"Helvetica\",\n    \"Impact\",\n    \"Lucida Grande\",\n    \"Optima\",\n    \"Segoe UI\",\n    \"Tahoma\",\n    \"Trebuchet MS\",\n    \"Verdana\",\n    \"Big Caslon\",\n    \"Bodoni MT\",\n    \"Book Antiqua\",\n    \"Calisto MT\",\n    \"Cambria\",\n    \"Didot\",\n    \"Garamond\",\n    \"Georgia\",\n    \"Goudy Old Style\",\n    \"Hoefler Text\",\n    \"Lucida Bright\",\n    \"Palatino\",\n    \"Perpetua\",\n    \"Rockwell\",\n    \"Rockwell Extra Bold\",\n    \"Baskerville\",\n    \"Times New Roman\",\n    \"Consolas\",\n    \"Courier New\",\n    \"Lucida Console\",\n    \"Lucida Sans Typewriter\",\n    \"Monaco\",\n    \"Andale Mono\",\n    \"Copperplate\",\n    \"Papyrus\",\n    \"Brush Script MT\"\n];\n//# sourceMappingURL=webFonts.js.map","import fonts from \"./webFonts\";\nexport default (message) => {\n    const splitText = [...randomCase(message)];\n    const blankStyle = `background-color: unset;font-size:${Math.random()}em`;\n    const styles = splitText.map(char => {\n        const { foreground, background, border } = getColors();\n        const [r, g, b] = foreground;\n        const [br, bg, bb] = background;\n        const style = `font-family:${randomFont()};color:rgb(${r}, ${g}, ${b});font-size:${3 + (Math.random() / 2)}em;line-height:${Math.random() + 0.5}em;background-color:rgb(${br}, ${bg}, ${bb});${randomPadding()}${randomOutline(border)}`;\n        return char === \" \" ? blankStyle : style;\n    });\n    const spacedText = splitText.join(\" \").split(\"\");\n    const spacedStyles = styles.map(item => [item, `font-size:${1 + (Math.random())}em;`]).flat().slice(0, -1);\n    return [spacedText, spacedStyles];\n};\nconst getColors = () => {\n    const isGray = Math.random() > 0.85;\n    const foreground = isGray ? randomRGBGrayValues(0, 64) : randomRGBValues([64, 64, 64], 128);\n    const background = isGray ? randomRGBGrayValues(192, 255) : randomRGBValues([255, 255, 255], 75);\n    const border = isGray ? randomRGBGrayValues(0, 128) : randomRGBValues([128, 128, 128], 128);\n    return { foreground, background, border };\n};\nconst randomPadding = (max = 3, min = 1) => `padding: ${(Math.random() * max) + min}px ${(Math.random() * max) + min}px ${(Math.random() * max) + min}px ${(Math.random() * max) + min}px;`;\nconst randomRGBValues = ([r, g, b] = [128, 128, 128], maxVariance = 25) => {\n    const randomlyVary = (baseValue, maxVary) => {\n        const randomAbsoluteVariance = Math.floor(Math.random() * maxVary);\n        const randomActualVariance = Math.random() >= 0.5 ? randomAbsoluteVariance * -1 : randomAbsoluteVariance;\n        return Math.max(Math.min(255, baseValue + randomActualVariance), 0);\n    };\n    return [randomlyVary(r, maxVariance), randomlyVary(g, maxVariance), randomlyVary(b, maxVariance)];\n};\nconst randomRGBGrayValues = (min, max) => {\n    const value = Math.floor(Math.random() * (max - min) + min);\n    return [value, value, value];\n};\nconst randomCase = (message) => {\n    const randomizedArray = message.split(\"\").map(char => {\n        const rand = Math.random();\n        return rand < 0.25 ? char : rand < 0.66 ? char.toUpperCase() : char.toLowerCase();\n    });\n    return randomizedArray.join(\"\");\n};\nconst randomOutline = (color) => {\n    const width = Math.random() > 0.45 ? Math.random() * 1.75 : 0;\n    const [r, g, b] = color || randomRGBValues([128, 128, 128], 128);\n    const colorString = `rgb(${r}, ${g}, ${b})`;\n    return `text-shadow: -${width}px -${width}px ${colorString}, ${width}px -${width}px ${colorString}, -${width}px ${width}px ${colorString}, ${width}px ${width}px ${colorString};`;\n};\nconst randomFont = () => {\n    const number = Math.floor(Math.random() * fonts.length);\n    return fonts[number];\n};\n//# sourceMappingURL=console_ransom.js.map","import logStyles from \"./styles\";\nimport getRansomArray from \"./console_ransom\";\nconst _inline = (stringSegmentArray, styleArray) => {\n    const stringSegments = stringSegmentArray.map((segment) => `%c${segment}`).join(\"\");\n    console.log(stringSegments, ...styleArray);\n};\nconst _customLog = function (message, style, logType = \"log\") {\n    if (window.CONSOLE_GAME_DEBUG) {\n        window.debugLog.push({ gameOutput: message });\n    }\n    if (Array.isArray(message) && Array.isArray(style)) {\n        _inline(message, style);\n    }\n    else {\n        console[logType](`%c${message}`, style);\n    }\n};\nconst _codeInline = (stringOrStringSegmentArray) => {\n    const baseStyle = logStyles.codeInlineBaseStyle;\n    const codeStyle = logStyles.codeInlineCodeStyle;\n    if (typeof stringOrStringSegmentArray === \"string\") {\n        _customLog(stringOrStringSegmentArray, codeStyle);\n    }\n    else {\n        const styleArray = Array(stringOrStringSegmentArray.length).fill(baseStyle).map((baseStyle, index) => {\n            // alternate between baseStyle and codeStyle\n            return index % 2 !== 0 ? codeStyle : baseStyle;\n        });\n        _customLog(stringOrStringSegmentArray, styleArray);\n    }\n};\nconst _digi = (message) => {\n    const spacedText = message.toUpperCase().split(\"\").join(\" \").split(\"\");\n    const styles = spacedText.map(char => logStyles.getDigiStyle());\n    _customLog(spacedText, styles);\n};\nconst _map = (floorMap) => {\n    console.table(floorMap.map(row => row.join(\"\")));\n};\nconst _scream = (message) => {\n    const splitText = [...message];\n    const styles = splitText.map((char, index) => {\n        return logStyles.getScreamStyle(index);\n    });\n    _customLog(splitText, styles);\n};\nconst _ransom = (message) => {\n    const [text, styles] = getRansomArray(message);\n    _inline(text, styles);\n};\nconst customConsole = (() => {\n    window.debugLog = [];\n    const log = {\n        inline: _inline,\n        codeInline: _codeInline,\n        digi: _digi,\n        map: _map,\n        scream: _scream,\n        custom: _customLog,\n        ransom: _ransom,\n        table: console.table,\n        groupCollapsed: console.groupCollapsed,\n        groupEnd: console.groupEnd,\n    };\n    // remaining log methods are created dynamically from the logStyles object\n    for (const styleName in logStyles) {\n        const styleDetails = logStyles[styleName];\n        // only iterate over the style objects, not the methods\n        if (typeof styleDetails === \"object\") {\n            const { style, logType } = styleDetails;\n            log[styleName] = (message) => _customLog(message, style, logType);\n        }\n    }\n    return log;\n})();\nexport default customConsole;\n//# sourceMappingURL=index.js.map","export const dogNames = [\n    \"Max\",\n    \"Buddy\",\n    \"Charlie\",\n    \"Jack\",\n    \"Cooper\",\n    \"Rocky\",\n    \"Toby\",\n    \"Tucker\",\n    \"Jake\",\n    \"Bear\",\n    \"Duke\",\n    \"Teddy\",\n    \"Oliver\",\n    \"Riley\",\n    \"Bailey\",\n    \"Bentley\",\n    \"Milo\",\n    \"Buster\",\n    \"Cody\",\n    \"Dexter\",\n    \"Winston\",\n    \"Murphy\",\n    \"Leo\",\n    \"Lucky\",\n    \"Oscar\",\n    \"Louie\",\n    \"Zeus\",\n    \"Henry\",\n    \"Sam\",\n    \"Harley\",\n    \"Baxter\",\n    \"Gus\",\n    \"Sammy\",\n    \"Jackson\",\n    \"Bruno\",\n    \"Diesel\",\n    \"Jax\",\n    \"Gizmo\",\n    \"Bandit\",\n    \"Rusty\",\n    \"Marley\",\n    \"Jasper\",\n    \"Brody\",\n    \"Roscoe\",\n    \"Hank\",\n    \"Otis\",\n    \"Bo\",\n    \"Joey\",\n    \"Beau\",\n    \"Ollie\",\n    \"Tank\",\n    \"Shadow\",\n    \"Peanut\",\n    \"Hunter\",\n    \"Scout\",\n    \"Blue\",\n    \"Rocco\",\n    \"Simba\",\n    \"Tyson\",\n    \"Ziggy\",\n    \"Boomer\",\n    \"Romeo\",\n    \"Apollo\",\n    \"Ace\",\n    \"Luke\",\n    \"Rex\",\n    \"Finn\",\n    \"Chance\",\n    \"Rudy\",\n    \"Loki\",\n    \"Moose\",\n    \"George\",\n    \"Samson\",\n    \"Coco\",\n    \"Benny\",\n    \"Thor\",\n    \"Rufus\",\n    \"Prince\",\n    \"Chester\",\n    \"Brutus\",\n    \"Scooter\",\n    \"Chico\",\n    \"Spike\",\n    \"Gunner\",\n    \"Sparky\",\n    \"Mickey\",\n    \"Kobe\",\n    \"Chase\",\n    \"Oreo\",\n    \"Frankie\",\n    \"Mac\",\n    \"Benji\",\n    \"Bubba\",\n    \"Champ\",\n    \"Brady\",\n    \"Elvis\",\n    \"Copper\",\n    \"Cash\",\n    \"Archie\",\n    \"Walter\",\n    \"Bella\",\n    \"Lucy\",\n    \"Daisy\",\n    \"Molly\",\n    \"Lola\",\n    \"Sophie\",\n    \"Sadie\",\n    \"Maggie\",\n    \"Chloe\",\n    \"Bailey\",\n    \"Roxy\",\n    \"Zoey\",\n    \"Lily\",\n    \"Luna\",\n    \"Coco\",\n    \"Stella\",\n    \"Gracie\",\n    \"Abby\",\n    \"Penny\",\n    \"Zoe\",\n    \"Ginger\",\n    \"Ruby\",\n    \"Rosie\",\n    \"Lilly\",\n    \"Ellie\",\n    \"Mia\",\n    \"Sasha\",\n    \"Lulu\",\n    \"Pepper\",\n    \"Nala\",\n    \"Lexi\",\n    \"Lady\",\n    \"Emma\",\n    \"Riley\",\n    \"Dixie\",\n    \"Annie\",\n    \"Maddie\",\n    \"Piper\",\n    \"Princess\",\n    \"Izzy\",\n    \"Maya\",\n    \"Olive\",\n    \"Cookie\",\n    \"Roxie\",\n    \"Angel\",\n    \"Belle\",\n    \"Layla\",\n    \"Missy\",\n    \"Cali\",\n    \"Honey\",\n    \"Millie\",\n    \"Harley\",\n    \"Marley\",\n    \"Holly\",\n    \"Kona\",\n    \"Shelby\",\n    \"Jasmine\",\n    \"Ella\",\n    \"Charlie\",\n    \"Minnie\",\n    \"Willow\",\n    \"Phoebe\",\n    \"Callie\",\n    \"Scout\",\n    \"Katie\",\n    \"Dakota\",\n    \"Sugar\",\n    \"Sandy\",\n    \"Josie\",\n    \"Macy\",\n    \"Trixie\",\n    \"Winnie\",\n    \"Peanut\",\n    \"Mimi\",\n    \"Hazel\",\n    \"Mocha\",\n    \"Cleo\",\n    \"Hannah\",\n    \"Athena\",\n    \"Lacey\",\n    \"Sassy\",\n    \"Lucky\",\n    \"Bonnie\",\n    \"Allie\",\n    \"Brandy\",\n    \"Sydney\",\n    \"Casey\",\n    \"Gigi\",\n    \"Baby\",\n    \"Madison\",\n    \"Heidi\",\n    \"Sally\",\n    \"Shadow\",\n    \"Cocoa\",\n    \"Pebbles\",\n    \"Misty\",\n    \"Nikki\",\n    \"Lexie\",\n    \"Grace\",\n    \"Sierra\"\n];\nexport const randomDogName = () => dogNames[Math.floor(Math.random() * dogNames.length)];\n//# sourceMappingURL=dogNames.js.map","const thesaurus = {\n    bed: [\"bedframe\", \"mattress\"],\n    booklet: [\"catalog\", \"catalogue\", \"book\", \"program\"],\n    bookshelves: [\"bookshelf\", \"shelf\", \"shelves\"],\n    burn: [\"ignite\", \"incinerate\", \"immolate\"],\n    collar: [\"dog_collar\", \"leash\"],\n    contemplate: [\n        \"consider\",\n        \"meditate\",\n        \"think\",\n        \"cogitate\",\n        \"cerebrate\",\n        \"ponder\",\n        \"excogitate\",\n        \"muse\",\n        \"reflect\",\n        \"mull\",\n        \"ruminate\",\n    ],\n    cup: [\"chalice\", \"goblet\"],\n    disc: [\"record\", \"album\", \"forty-five\", \"disk\", \"recording\", \"litany\"],\n    drink: [\"intake\", \"uptake\", \"imbibe\", \"chug\", \"guzzle\", \"quaff\"],\n    drop: [\n        \"unload\",\n        \"discharge\",\n        \"dismiss\",\n        \"shed\",\n        \"discard\",\n        \"release\",\n        \"shitcan\",\n        \"trash\",\n        \"expel\",\n        \"abandon\",\n        \"forsake\",\n    ],\n    eat: [\"ingest\", \"consume\", \"swallow\", \"devour\"],\n    examine: [\n        \"analyze\",\n        \"analyse\",\n        \"study\",\n        \"investigate\",\n        \"inspect\",\n        \"scan\",\n        \"search\",\n    ],\n    extinguish: [\"douse\"],\n    film: [\"movie\", \"reel\", \"cartridge\", \"film_cartridge\"],\n    glove: [\"mitt\", \"gloves\", \"handwear\", \"mitten\", \"mittens\"],\n    go: [\"travel\", \"locomote\", \"proceed\", \"depart\", \"exit\", \"leave\", \"run\"],\n    grue_repellant: [\"repellant\", \"aerosol\"],\n    help: [\"assistance\", \"support\", \"ayuda\"],\n    inventory: [\"booty\", \"bounty\", \"hoard\", \"possessions\", \"belongings\"],\n    lantern: [\"lamp\", \"torch\"],\n    listen: [\"hear\"],\n    lock: [\"deadbolt\"],\n    look: [\"see\", \"observe\", \"status\"],\n    maps: [\"map\", \"plan\", \"plans\", \"blueprints\", \"blueprint\"],\n    matchbook: [\"matches\", \"match\"],\n    move: [\"displace\", \"upend\", \"push\"],\n    note: [\"letter\", \"missive\", \"paper\", \"epistle\", \"treatise\"],\n    open: [\"unclose\"],\n    painting: [\"canvas\", \"artwork\"],\n    phonograph: [\"record_player\", \"turntable\"],\n    photo: [\"photograph\", \"picture\", \"pic\", \"portrait\", \"frame\", \"picture_frame\"],\n    pull: [\"tug\", \"yank\", \"jerk\"],\n    read: [\"skim\", \"peruse\"],\n    safe: [\n        \"alcove\",\n        \"strongbox\",\n        \"vault\",\n        \"wall_safe\",\n    ],\n    scroll: [\n        \"strap\",\n        \"parchment\",\n        \"spell\",\n    ],\n    smell: [\"sniff\"],\n    spray: [\n        \"squirt\",\n        \"spurt\",\n        \"spirt\",\n        \"scatter\",\n        \"sprinkle\",\n        \"disperse\",\n        \"dispense\",\n    ],\n    start: [\"begin\", \"commence\"],\n    take: [\n        \"acquire\",\n        \"steal\",\n        \"purloin\",\n        \"pilfer\",\n        \"obtain\",\n        \"gank\",\n        \"get\",\n        \"appropriate\",\n        \"arrogate\",\n        \"confiscate\",\n        \"retrieve\",\n        \"remove\",\n    ],\n    toilet: [\"commode\", \"crapper\", \"loo\", \"head\"],\n    turn: [\"flip\", \"rotate\", \"revolve\", \"twist\"],\n    use: [\n        \"activate\",\n        \"utilize\",\n        \"utilise\",\n        \"apply\",\n        \"employ\",\n        \"exploit\",\n        \"expend\",\n    ],\n    wait: [\n        \"abide\",\n        \"await\",\n        \"delay\",\n        \"tarry\",\n        \"chill\",\n        \"exist\",\n        \"dawdle\",\n        \"dillydally\",\n        \"loiter\",\n        \"pause\",\n        \"rest\",\n        \"relax\",\n        \"remain\",\n        \"hesitate\",\n        \"procrastinate\",\n        \"sit\",\n    ],\n    yell: [\"shout\", \"scream\", \"cry\"],\n};\nconst allWords = Object.entries(thesaurus).reduce((accum, entry) => {\n    return [...accum, ...entry[1]];\n}, []);\nconst duplicates = allWords.filter((word, currentIndex) => allWords.indexOf(word) !== currentIndex);\nif (duplicates.length) {\n    throw Error(`Duplicates found in thesaurus.js:\\n${duplicates}`);\n}\nexport default thesaurus;\n//# sourceMappingURL=thesaurus.js.map","// IIFE returns three-dimensional array of maps\nexport default (function () {\n    // This function uses .split() to convert an array of simplified maps from one to two-dimensional arrays, and then return them in the order given as a three-dimensional array.\n    const processMaps = (arrayOfUnexpandedMapArrays) => {\n        const output = arrayOfUnexpandedMapArrays.map((mapArray) => {\n            const expandedMap = mapArray.map((line) => [...line]);\n            return expandedMap;\n        });\n        return output;\n    };\n    // Maps are simplified as arrays of strings. Asterisks are impassable boundaries. Maps should be contained by a perimeter of asterisks to limit x-axis and y-axis, and and upper and lower boundary of asterisks to limit Z-axis. Floor separator maps mark locations that z-axis can be traversed.\n    const boundary = [\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\"\n    ];\n    const basement = [\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"*******CI*******\",\n        \"******)B********\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\"\n    ];\n    const floorSeparator1 = [\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"******(*********\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\"\n    ];\n    const groundFloor = [\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"********ZZa*****\",\n        \"******@=XZ******\",\n        \"*******=********\",\n        \"******+%J*******\",\n        \"*******%********\",\n        \"*******A********\",\n        \"****************\"\n    ];\n    const floorSeparator2 = [\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"*******#********\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\"\n    ];\n    const secondFloor = [\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"****************\",\n        \"*******^********\",\n        \"******0-FG******\",\n        \"*******-*H******\",\n        \"******E-D*******\",\n        \"*******$********\",\n        \"****************\"\n    ];\n    return processMaps([boundary, basement, floorSeparator1, groundFloor, floorSeparator2, secondFloor, boundary]);\n})();\n//# sourceMappingURL=maps.js.map","export default {\n    // dictionary of items that contain other items\n    _glove: [\"_matchbook\"],\n    _safe: [\"_key\", \"_scroll\"],\n    _drawer: [\"_film\"],\n    _nightstand_drawer: [\"_old_key\"],\n    _wardrobe: [\"_grue_repellant\"],\n    _dresser_drawer: [\"_booklet\"]\n};\n//# sourceMappingURL=itemContents.js.map","export default {\"_all\":\"(game) => {\\n    return {\\n        name: \\\"all\\\",\\n        listed: false,\\n        takeable: false,\\n        take() {\\n            game.state.objectMode = false;\\n            const all = game.state.combinedEnv;\\n            all.forEach((item) => {\\n                return item.takeable ? (item.take && item.take()) : null;\\n            });\\n        },\\n        drop() {\\n            game.state.objectMode = false;\\n            const all = game.state.inventory.filter((it) => ![\\\"no_tea\\\", \\\"me\\\"].includes(it.name)); // filter out \\\"no_tea\\\" (you can't drop it)\\n            all.forEach((item) => {\\n                item.drop && item.drop();\\n            });\\n        }\\n    };\\n}\",\"_backdoor\":\"{\\\"name\\\":\\\"door\\\",\\\"locked\\\":true,\\\"proto\\\":\\\"door\\\",\\\"unlockedBy\\\":\\\"key\\\",\\\"lockedTarget\\\":\\\"a\\\",\\\"closedTarget\\\":\\\"a\\\"}\",\"_basement_door\":\"{\\\"name\\\":\\\"door\\\",\\\"locked\\\":true,\\\"closed\\\":true,\\\"listed\\\":true,\\\"proto\\\":\\\"door\\\",\\\"unlockedBy\\\":\\\"old_key\\\",\\\"lockedTarget\\\":\\\"I\\\",\\\"closedTarget\\\":\\\"I\\\"}\",\"_bathtub\":\"(game) => {\\n    return {\\n        name: \\\"bathtub\\\",\\n        takeable: false,\\n        description: \\\"The old cast iron tub rests atop four taloned feet. It does not look functional.\\\",\\n        use() {\\n            game.log.p(\\\"This is hardly an appropriate time for a bath!\\\");\\n        }\\n    };\\n}\",\"_bed\":\"(game) => {\\n    return {\\n        name: \\\"bed\\\",\\n        flammable: true,\\n        takeable: false,\\n        listed: false,\\n        description: \\\"The antique bedframe is made of tubular bronze. There are not any sheets or blankets or pillows on the old, stained, queen-sized mattress that rests atop it.\\\",\\n        burn() {\\n            Object.getPrototypeOf(this).burnDown.call(this);\\n        },\\n    };\\n}\",\"_booklet\":\"(game) => {\\n    return {\\n        name: \\\"booklet\\\",\\n        article: \\\"a\\\",\\n        flammable: true,\\n        description: \\\"This booklet appears to be the exhibition catalogue for some fancy art show. \\\",\\n        read() {\\n            game.state.objectMode = false;\\n            if (!game.inInventory(this.name)) {\\n                return game.log.p(`You will need to pick up the ${this.name} first.`);\\n            }\\n            game.displayItem({\\n                title: \\\"Ministry of Culture\\\",\\n                artist: \\\"Isak Berbic, Emiliano Cerna-Rios, Dennis Hodges and Zdenko Mandusic\\\",\\n                year: \\\"2008\\\",\\n                info: \\\"Exhibition catalog\\\",\\n                source: \\\"https://drive.google.com/file/d/1pJcIPQZxY1JhRZ3ssV-EPL6eWY-XLdpI/preview\\\",\\n                width: \\\"800px\\\",\\n                height: \\\"800px\\\"\\n            });\\n        }\\n    };\\n}\",\"_books\":\"(game) => {\\n    return {\\n        name: \\\"books\\\",\\n        listed: false,\\n        takeable: false,\\n        description: \\\"While you notice many of the titles as familiar works of classic literature, nothing stands out as being of particular interest.\\\",\\n        read() {\\n            game.log.p(\\\"You cannot possibly read all of these books, and considering you have been abducted by persons unknown and are trapped in a strange house, you have neither the presence of mind, nor the time to sit down with a good book right now.\\\");\\n        },\\n        proto: \\\"bookshelves\\\",\\n    };\\n}\",\"_bookshelves\":\"{\\\"name\\\":\\\"bookshelves\\\",\\\"listed\\\":false,\\\"takeable\\\":false,\\\"article\\\":\\\"some\\\",\\\"description\\\":\\\"Wooden bookshelves line one wall of the study, reaching from floor to ceiling. There are hundreds of moldering, hardcover books lining the shelves.\\\"}\",\"_chain\":\"(game) => {\\n    return {\\n        name: \\\"chain\\\",\\n        weight: 0,\\n        description: \\\"The thin ball chain dangling in front of you is exactly the sort often connected to a lightbulb. Perhaps you should \\\\\\\"pull\\\\\\\" it...\\\",\\n        takeable: false,\\n        listed: false,\\n        pull() {\\n            game.state.objectMode = false;\\n            let dark = game.state.currentMapCell.hideSecrets;\\n            dark ? game.log.p(\\\"An overhead lightbulb flickers on, faintly illuminating the room.\\\") : game.log.p(\\\"The lightbulb is extinguished.\\\");\\n            game.state.currentMapCell.hideSecrets = !dark;\\n            return game.describeSurroundings();\\n        },\\n        use() {\\n            return this.pull();\\n        }\\n    };\\n}\",\"_chair\":\"(game) => {\\n    return {\\n        name: \\\"chair\\\",\\n        takeable: false,\\n        description: \\\"It looks like a wooden chair– no more, no less.\\\",\\n        use() {\\n            game.state.objectMode = false;\\n            game.log.p(\\\"You sit down on the chair.\\\");\\n            const wait = game.commands._wait;\\n            wait.call(this);\\n        }\\n    };\\n}\",\"_coffee_table\":\"(game) => {\\n    return {\\n        name: \\\"coffee_table\\\",\\n        listed: false,\\n        takeable: false,\\n        description() {\\n            return `The low, four-legged table has nothing on it${game.state.env.visibleEnv.includes(\\\"photo\\\")\\n                ? \\\" except for a small, framed photo.\\\"\\n                : \\\".\\\"}`;\\n        },\\n    };\\n}\",\"_collar\":\"(game) => {\\n    return {\\n        name: \\\"collar\\\",\\n        points: 2,\\n        description: `It is ${game.state.dogName}'s collar! Whoever assaulted you and took your dog must have come this way!`,\\n        smell() {\\n            game.log.p(\\\"The collar smells like leather and scared doggie!\\\");\\n        }\\n    };\\n}\",\"_cup\":\"{\\\"name\\\":\\\"cup\\\",\\\"weight\\\":2,\\\"description\\\":\\\"It is a small, golden cup with two finely wrought handles.\\\"}\",\"_desk\":\"{\\\"name\\\":\\\"desk\\\",\\\"takeable\\\":false,\\\"openable\\\":true,\\\"closed\\\":true,\\\"containedPart\\\":\\\"_drawer\\\",\\\"description\\\":\\\"The antique writing desk is six feet in length, and blanketed with dust. It has a single drawer on one side.\\\"}\",\"_disc\":\"(game) => {\\n    return {\\n        name: \\\"disc\\\",\\n        text: \\\"Untitled (Litany)\\\",\\n        get description() {\\n            return `It is a disc made of a shiny black polymer, lined with hundreds of tiny concentric grooves. It looks to be about seven inches in diameter, with a one and one-half inch hole in its center. It bears a label that says, \\\"${this.text}\\\".`;\\n        },\\n        play() {\\n            if (!game.inEnvironment(\\\"phonograph\\\") && !game.inInventory(\\\"phonograph\\\")) {\\n                game.log.p(\\\"First, you will need to find a phonograph.\\\");\\n                return;\\n            }\\n            return game.displayItem({\\n                title: \\\"\\\\nUntitled (litany)\\\",\\n                artist: \\\"Dennis Hodges\\\",\\n                year: \\\"2010\\\",\\n                info: \\\"Found audio recordings\\\",\\n                source: \\\"https://drive.google.com/file/d/1s02tHvAU0E7dMJgbhUnIPNg8ayWGNmxZ/preview?usp=sharing\\\"\\n            });\\n        },\\n        use() {\\n            this.play.call(this);\\n        },\\n    };\\n}\",\"_dog\":\"{\\\"name\\\":\\\"dog\\\",\\\"points\\\":50,\\\"article\\\":\\\"a\\\",\\\"takeable\\\":true,\\\"description\\\":\\\"Four legs. Barks.\\\",\\\"rescue\\\":\\\"rescue() {\\\\n        Object.getPrototypeOf(this).take.call(this);\\\\n    }\\\"}\",\"_door\":\"(game) => {\\n    return {\\n        name: \\\"door\\\",\\n        article: \\\"a\\\",\\n        points: 20,\\n        openable: true,\\n        locked: false,\\n        closed: true,\\n        takeable: false,\\n        listed: false,\\n        unlockedBy: \\\"key\\\",\\n        lockedTarget: \\\"A\\\",\\n        closedTarget: \\\"A\\\",\\n        get description() {\\n            game.state.objectMode = false;\\n            return `The massive wooden door, darkened with generations of dirt and varnish, is secured with a sturdy new deadbolt, which is ${!this.locked ? \\\"unlocked.\\\" : \\\"locked.\\\"}${this.closed ? \\\"\\\" : \\\"\\\\nThe door is open.\\\"}`;\\n        },\\n    };\\n}\",\"_drawer\":\"(game) => {\\n    const drawer = {\\n        randomNumber: Math.floor(Math.random() * 10000),\\n        name: \\\"drawer\\\",\\n        listed: false,\\n        openable: true,\\n        closed: true,\\n        takeable: false,\\n        containedIn: \\\"_desk\\\",\\n        contents: [],\\n        get description() {\\n            return this.closed\\n                ? \\\"The drawer is closed.\\\"\\n                : `The drawer is open. There is ${this.contents.length < 1\\n                    ? \\\"nothing\\\"\\n                    : game.formatList(this.contents.map((item) => `${item.article} ${item.name}`))} inside.`;\\n        },\\n        open() {\\n            if (this.closed) {\\n                Object.getPrototypeOf(this).open.call(this);\\n            }\\n            if (game.items[this.containedIn].closed) {\\n                game.items[this.containedIn].closed = false;\\n            }\\n        },\\n        close() {\\n            if (!this.closed) {\\n                Object.getPrototypeOf(this).close.call(this);\\n            }\\n            if (!game.items[this.containedIn].closed) {\\n                game.items[this.containedIn].closed = true;\\n            }\\n        },\\n    };\\n    return drawer;\\n}\",\"_dresser\":\"(game) => {\\n    return {\\n        name: \\\"dresser\\\",\\n        takeable: false,\\n        openable: true,\\n        closed: true,\\n        listed: true,\\n        proto: \\\"desk\\\",\\n        containedPart: \\\"_dresser_drawer\\\",\\n        contents: [],\\n        get description() {\\n            return `The modest wooden dresser is of simple design. The pale blue milk paint that coats it is worn through in several spots from use. It has a large drawer, which is ${this.closed ? \\\"closed\\\" : \\\"open\\\"}.`;\\n        },\\n        open() {\\n            const proto = Object.getPrototypeOf(this);\\n            const urOpen = Object.getPrototypeOf(proto).open.bind(this);\\n            urOpen.call(this); // open method from prototype's prototype\\n            proto.open.call(this); // open method of prototype\\n        },\\n        close() {\\n            const proto = Object.getPrototypeOf(this);\\n            const urClose = Object.getPrototypeOf(proto).close.bind(this);\\n            urClose.call(this); // close method from prototype's prototype\\n            proto.close.call(this); // open method of prototype\\n        },\\n    };\\n}\",\"_dresser_drawer\":\"(game) => {\\n    return {\\n        name: \\\"drawer\\\",\\n        takeable: false,\\n        openable: true,\\n        closed: true,\\n        listed: false,\\n        proto: \\\"drawer\\\",\\n        containedIn: \\\"_dresser\\\",\\n        contents: [],\\n        open() {\\n            const proto = Object.getPrototypeOf(this);\\n            const urOpen = Object.getPrototypeOf(proto).open.bind(this);\\n            urOpen.call(this); // open method from prototype's prototype\\n            proto.open.call(this); // open method of prototype\\n        },\\n        close() {\\n            const proto = Object.getPrototypeOf(this);\\n            const urClose = Object.getPrototypeOf(proto).close.bind(this);\\n            urClose.call(this); // close method from prototype's prototype\\n            proto.close.call(this); // open method of prototype\\n        },\\n    };\\n}\",\"_film\":\"(game) => {\\n    return {\\n        name: \\\"film\\\",\\n        listed: true,\\n        flammable: true,\\n        article: \\\"a reel of\\\",\\n        text: \\\"Canned Laughs\\\",\\n        description: 'The Super 8 film cartridge is made primarily of a clear, smoky plastic body containing a single spool of developed film. It looks a lot like an audio cassette tape, though it is a little thicker, and it is square instead of being merely rectangular. The title, \\\"Canned Laughs\\\", is hand written on a curling paper label.',\\n        play() {\\n            if (!game.inEnvironment(\\\"projector\\\") && !game.inInventory(\\\"projector\\\")) {\\n                game.log.p(\\\"First, you will need to find something to project the film with.\\\");\\n                return;\\n            }\\n            if (!game.inEnvironment(\\\"screen\\\") && !game.inInventory(\\\"screen\\\")) {\\n                game.log.p(\\\"You are going to need a screen to project onto.\\\");\\n                return;\\n            }\\n            return game.displayItem({\\n                title: \\\"\\\\nCanned Laughs\\\",\\n                artist: \\\"Dennis Hodges\\\",\\n                year: \\\"2001\\\",\\n                info: \\\"Super 8mm film to video transfer with dubbed audio\\\",\\n                source: \\\"https://drive.google.com/file/d/1loiWbLQgHVVoCtJVscJe2sYiPle8u7Tf/preview?usp=sharing\\\",\\n                width: \\\"720px\\\",\\n                height: \\\"480px\\\",\\n            });\\n        },\\n        use() {\\n            this.play.call(this);\\n        },\\n        project() {\\n            this.play.call(this);\\n        },\\n    };\\n}\",\"_filthy_note\":\"{\\\"name\\\":\\\"note\\\",\\\"text\\\":\\\"Dear John,\\\\nI'm leaving. After all of this time, I said it. But I want you to understand that it is not because of you, or something you've done (you have been a loving and loyal partner). It is I who have changed. I am leaving because I am not the person who married you so many years ago; that, and the incredibly low, low prices at Apple Cabin. Click here ==> http://liartownusa.tumblr.com/post/44189893625/apple-cabin-foods-no-2 to see why I prefer their produce for its quality and respectability.\\\",\\\"description\\\":\\\"A filthy note you found on the floor of a restroom. Congratulations, it is still slightly damp. Despite its disquieting moistness, the text is still legible.\\\"}\",\"_glove\":\"(game) => {\\n    return {\\n        name: \\\"glove\\\",\\n        closed: true,\\n        points: 1,\\n        description: \\\"It is a well-worn gray leather work glove. There is nothing otherwise remarkable about it.\\\",\\n        contents: [],\\n        examine() {\\n            game.state.objectMode = false;\\n            if (this.contents.length) {\\n                const hiddenItem = this.contents.pop();\\n                game.log.p(`${this.description}\\\\nAs you examine the glove, a ${hiddenItem.name} falls out, onto the floor.`);\\n                game.state.currentMapCell.addToEnv(hiddenItem.name);\\n                return;\\n            }\\n            return this.description;\\n        }\\n    };\\n}\",\"_grue\":\"(game) => {\\n    return {\\n        name: \\\"grue\\\",\\n        listed: false,\\n        takeable: false,\\n        turns: 3,\\n        description: \\\"No adventurer who has seen a grue has yet lived to tell of it.\\\",\\n        lurk() {\\n            if (!game.state.currentMapCell.hideSecrets) {\\n                return;\\n            }\\n            const valarMorgulis = Math.random() >= 0.25;\\n            if (valarMorgulis && this.turns < 1) {\\n                game.dead(\\\"Oh no! You have walked into the slavering fangs of a lurking grue!\\\");\\n            }\\n            this.turns--;\\n            return;\\n        },\\n    };\\n}\",\"_grue_repellant\":\"(game) => {\\n    return {\\n        name: \\\"grue_repellant\\\",\\n        defective: Math.random() < 0.03,\\n        weight: 3,\\n        count: 3,\\n        points: 3,\\n        article: \\\"some\\\",\\n        description: \\\"A 12oz can of premium aerosol grue repellant. This is the good stuff. Grues genuinely find it to be somewhat off-putting.\\\",\\n        use() {\\n            game.state.objectMode = false;\\n            if (!game.inInventory(this.name)) {\\n                return game.inEnvironment(this.name) ? game.log.p(\\\"You will need to pick it up first.\\\") : game.log.p(\\\"You don't see that here.\\\");\\n            }\\n            else if (this.used) {\\n                return game.log.p(\\\"Sorry, but it has already been used.\\\");\\n            }\\n            else if (this.defective) {\\n                this.used = true;\\n                return game.log.p(\\\"Nothing happens. This must be one of the Math.random() < 0.03 of grue_repellant cans that were programmed to be, I mean, that were accidentally manufactured defectively. Repeated attempts to coax repellant from the aerosol canister prove equally fruitless.\\\");\\n            }\\n            else {\\n                this.used = true;\\n                this.activated = true;\\n                game.state.repellantMode = true;\\n                return game.log.p(\\\"A cloud of repellant hisses from the canister, temporarily obscuring your surroundings. By the time it clears, your head begins to throb, and you feel a dull, leaden taste coating your tongue. The edges of your eyes and nostrils feel sunburnt, and there is also a burning sensation to accompany an unsteady buzzing in your ears. Although you are not a grue, you find it to be more than somewhat off-putting.\\\");\\n            }\\n        },\\n        spray() {\\n            game.state.objectMode = false;\\n            return this.use();\\n        },\\n        drink() {\\n            game.state.objectMode = false;\\n            game.dead(\\\"Drinking from an aerosol can is awkward at best, but still you manage to ravenously slather your chops with the foaming grue repellant. You try to enjoy the searing pain inflicted by this highly caustic (and highly toxic!) chemical as it dissolves the flesh of your mouth and throat, but to no avail. It is not delicious, and you are starting to realize that there are some non-trivial drawbacks to willingly ingesting poison. Oops.\\\");\\n        },\\n        decrementCounter() {\\n            if (this.activated && this.count > 0) {\\n                --this.count;\\n                if (this.count === 0) {\\n                    game.log.p(\\\"The grue repellant has probably worn off by now.\\\");\\n                    this.activated = false;\\n                    game.state.repellantMode = false;\\n                    return;\\n                }\\n            }\\n        }\\n    };\\n}\",\"_key\":\"(game) => {\\n    return {\\n        name: \\\"key\\\",\\n        points: 10,\\n        description: \\\"The shiny key is made of untarnished brass and looks new, like it could have been cut yesterday.\\\",\\n        use() {\\n            const unlockable = game.state.combinedEnv.filter((item) => item.unlockedBy === this.name);\\n            if (unlockable.length < 1) {\\n                game.log.p(`There is nothing to unlock with the ${this.name}`);\\n                return;\\n            }\\n            unlockable.forEach((item) => item.unlock());\\n        },\\n    };\\n}\",\"_keypad\":\"(game) => {\\n    return {\\n        name: \\\"keypad\\\",\\n        takeable: false,\\n        openable: true,\\n        closed: true,\\n        listed: false,\\n        solution: null,\\n        proto: \\\"safe\\\",\\n        containedIn: \\\"_safe\\\",\\n        closedTarget: \\\"_safe\\\",\\n        contents: [],\\n        description: \\\"The keypad has a liquid crystal display screen and a row of buttons numbered 0 through 9.\\\",\\n    };\\n}\",\"_knife\":\"(game) => {\\n    return {\\n        name: \\\"knife\\\",\\n        points: 1,\\n        description: \\\"The folding knife has a three inch locking blade and is small enough to fit in your pocket. It is designed to be a utility blade, and would probably make a poor weapon.\\\",\\n        use() {\\n            game.log.p(\\\"The small knife is of no use here.\\\");\\n        },\\n    };\\n}\",\"_lantern\":\"(game) => {\\n    return {\\n        name: \\\"lantern\\\",\\n        flammable: false,\\n        activated: false,\\n        points: 5,\\n        proto: \\\"matchbook\\\",\\n        get description() {\\n            return `The old brass lantern is the quaint sort that burns hydrocarbons to produce light. It is currently ${this.activated ? \\\"lit.\\\" : \\\"extinguished.\\\"}`;\\n        },\\n        use() {\\n            game.state.objectMode = false;\\n            if (!game.inInventory(\\\"matchbook\\\")) {\\n                game.log.p(\\\"You don't have the means to light a fire.\\\");\\n                return;\\n            }\\n            if (this.count === 0) {\\n                game.log.p(\\\"The lantern appears to be out of fuel.\\\");\\n                return;\\n            }\\n            game.items._matchbook.closed = false;\\n            this.activated = true;\\n            this.count = 250;\\n            game.log.p(\\\"Lighting the lantern with the match produces a brighter, longer lasting source of light.\\\");\\n        },\\n        light() {\\n            this.use.call(this);\\n        },\\n        burn() {\\n            this.use.call(this);\\n        },\\n    };\\n}\",\"_maps\":\"(game) => {\\n    return {\\n        name: \\\"maps\\\",\\n        article: \\\"some\\\",\\n        points: 5,\\n        get description() {\\n            this.read();\\n            return `The stack of dogeared pages appear to be architectural drawings. With a quick survey of your surroundings, you confirm with reasonable certainty that they are likely floor plans for this house.`;\\n        },\\n        read() {\\n            game.state.objectMode = false;\\n            if (!game.inInventory(this.name)) {\\n                return game.log.p(`You will need to pick up the ${this.name} first.`);\\n            }\\n            const floorMap = game.getFloorMap();\\n            game.log.map(floorMap);\\n            game.displayHTMLMap(floorMap);\\n            if (!game.turnDaemon.hasTimer(\\\"map\\\")) {\\n                game.turnDaemon.registerTimer(\\\"map\\\", (gameContext) => {\\n                    gameContext.displayHTMLMap(gameContext.getFloorMap());\\n                });\\n            }\\n        },\\n        use() {\\n            this.read.call(this);\\n        },\\n    };\\n}\",\"_matchbook\":\"(game) => {\\n    return {\\n        name: \\\"matchbook\\\",\\n        openable: true,\\n        closed: true,\\n        count: 3,\\n        points: 7,\\n        flammable: true,\\n        get description() {\\n            return `It is an old paper matchbook, of the type that used to be given away with packs of cigarettes, or printed with the name and telephone number of a business and used as marketing schwag. This particular specimen is beige, with black and white text that says \\\\\\\"Magnum Opus\\\\\\\" in a peculiar, squirming op-art font. ${this.closed\\n                ? \\\"It is closed, its cardboard cover tucked in.\\\"\\n                : 'The cardboard cover is open, and you can see a handwritten message on the inside. It says, \\\"THE OWLS ARE NOT WHAT THEY SEEM.\\\"'}`;\\n        },\\n        decrementCounter() {\\n            if (this.lightCount) {\\n                --this.count;\\n                if (this.count === 0) {\\n                    game.log.p(\\\"Despite your best efforts the flame flickers out.\\\");\\n                    this.activated = false;\\n                    return;\\n                }\\n            }\\n        },\\n        use() {\\n            game.state.objectMode = false;\\n            if (this.closed) {\\n                this.open.call(this);\\n                game.log.p(\\\"As you flip open the matchbook, folding back the cover, you glimpse something scrawled in pencil on the inside.\\\");\\n            }\\n            game.log.p(\\\"You pluck out one of the paper matches. It ignites easily as you scrape its head against the red phosphorus strip, producing a tenuous flame that you are quick to guard with your cupped hand.\\\");\\n            this.count = 3;\\n            this.activated = true;\\n        },\\n        light() {\\n            this.use.call(this);\\n        },\\n    };\\n}\",\"_me\":\"(game) => {\\n    return {\\n        name: \\\"me\\\",\\n        article: \\\"\\\",\\n        takeable: false,\\n        listed: false,\\n        get description() {\\n            const descriptionString = `Upon taking a quick inventory of your person and its component parts – everything seems to be accounted for and intact.`;\\n            return descriptionString;\\n        },\\n    };\\n}\",\"_nightstand\":\"(game) => {\\n    return {\\n        name: \\\"nightstand\\\",\\n        takeable: false,\\n        openable: true,\\n        closed: true,\\n        listed: false,\\n        proto: \\\"desk\\\",\\n        containedPart: \\\"_nightstand_drawer\\\",\\n        contents: [],\\n        get description() {\\n            return `The nightstand next to the bed is made of wood and is painted white. It has a single drawer, which is ${this.closed ? \\\"closed\\\" : \\\"open\\\"}.`;\\n        },\\n        open() {\\n            const proto = Object.getPrototypeOf(this);\\n            const urOpen = Object.getPrototypeOf(proto).open.bind(this);\\n            urOpen.call(this); // open method from prototype's prototype\\n            proto.open.call(this); // open method of prototype\\n        },\\n        close() {\\n            const proto = Object.getPrototypeOf(this);\\n            const urClose = Object.getPrototypeOf(proto).close.bind(this);\\n            urClose.call(this); // close method from prototype's prototype\\n            proto.close.call(this); // open method of prototype\\n        },\\n    };\\n}\",\"_nightstand_drawer\":\"(game) => {\\n    return {\\n        name: \\\"drawer\\\",\\n        takeable: false,\\n        openable: true,\\n        closed: true,\\n        listed: false,\\n        proto: \\\"drawer\\\",\\n        containedIn: \\\"_nightstand\\\",\\n        contents: [],\\n        open() {\\n            const proto = Object.getPrototypeOf(this);\\n            const urOpen = Object.getPrototypeOf(proto).open.bind(this);\\n            urOpen.call(this); // open method from prototype's prototype\\n            proto.open.call(this); // open method of prototype\\n        },\\n        close() {\\n            const proto = Object.getPrototypeOf(this);\\n            const urClose = Object.getPrototypeOf(proto).close.bind(this);\\n            urClose.call(this); // close method from prototype's prototype\\n            proto.close.call(this); // close method of prototype\\n        },\\n    };\\n}\",\"_no_tea\":\"(game) => {\\n    return {\\n        name: \\\"no_tea\\\",\\n        weight: 0,\\n        article: \\\"\\\",\\n        description: \\\"You do not have any tea.\\\",\\n        methodCallcount: 0,\\n        takeable: false,\\n        no_teaMethod(message) {\\n            this.methodCallcount++;\\n            game.state.objectMode = false;\\n            game.log.p(message);\\n            if (this.methodCallcount > 1 &&\\n                game.state.pendingAction !== \\\"contemplate\\\") {\\n                game.log.p(\\\"Perhaps you should take a moment to contemplate that.\\\");\\n            }\\n        },\\n        drink() {\\n            return this.no_teaMethod(\\\"How do you intend to drink no tea?\\\");\\n        },\\n        drop() {\\n            return this.no_teaMethod(\\\"You can't very well drop tea that you don't have.\\\");\\n        },\\n        take() {\\n            return this.no_teaMethod(\\\"No tea isn't the sort of thing you can take.\\\");\\n        },\\n        examine() {\\n            return this.no_teaMethod(this.description);\\n        },\\n        frotz() {\\n            return this.no_teaMethod('Unfortunately, you cannot \\\"frotz\\\" the no tea.');\\n        },\\n        use() {\\n            return this.no_teaMethod(\\\"Unsurprisingly, using the no tea has no effect.\\\");\\n        },\\n        contemplate() {\\n            if (this.methodCallcount > 2) {\\n                game.state.score += 75;\\n                game.winner(\\\"Having thoroughly contemplated the existential ramifications of no tea, you suddenly find that your being transcends all time and space.\\\");\\n            }\\n            else {\\n                return this.no_teaMethod(\\\"Let's not resort to that just yet!\\\");\\n            }\\n        },\\n    };\\n}\",\"_note\":\"(game) => {\\n    return {\\n        name: \\\"note\\\",\\n        text: `We have your dog.`,\\n        flammable: true,\\n        firstRead: true,\\n        description: \\\"The note is composed of eclectically sourced, cut-out letters, in the style of a movie ransom note. You found it lying next to you on the floor when you regained consciousness.\\\",\\n        read() {\\n            game.state.objectMode = false;\\n            if (!game.inInventory(this.name)) {\\n                return game.log.p(`You will need to pick up the ${this.name} first.`);\\n            }\\n            game.log.ransom(this.text);\\n            if (this.firstRead) {\\n                game.log.p(`Who would do such a thing to sweet little ${game.state.dogName}!?`);\\n                game.log.p(\\\"You need to rescue your puppy and get out of this place before your attacker returns!\\\");\\n                this.firstRead = false;\\n            }\\n        },\\n    };\\n}\",\"_old_key\":\"{\\\"name\\\":\\\"old_key\\\",\\\"points\\\":5,\\\"article\\\":\\\"an\\\",\\\"description\\\":\\\"It is an old-fashioned key, made of heavy, tarnished bronze.\\\",\\\"proto\\\":\\\"key\\\"}\",\"_painting\":\"(game) => {\\n    return {\\n        name: \\\"painting\\\",\\n        takeable: true,\\n        listed: false,\\n        flammable: true,\\n        description: \\\"The small, grimy image is of an owl, teaching a class a classroom of kittens how to catch mice. The rendering of perspective is amateurish, and the depicted animals look hostile and disfigured. It is an awful painting.\\\",\\n        previouslyRevealed: false,\\n        location: \\\"+\\\",\\n        take() {\\n            Object.getPrototypeOf(this).take.call(this);\\n            this.revealText(\\\"When you remove the terrible painting, \\\");\\n        },\\n        revealText(text) {\\n            if (!this.previouslyRevealed) {\\n                game.log.p(text +\\n                    \\\"a small recess is revealed. Within the shallow niche is a small black wall safe, covered with countless shallow dents, scratches and abrasions.\\\");\\n                game.mapKey[this.location].hideSecrets = false;\\n                this.previouslyRevealed = true;\\n            }\\n        },\\n        move() {\\n            this.revealText(\\\"When you move the terrible painting, \\\");\\n        },\\n        turn() {\\n            this.move();\\n        },\\n        burn() {\\n            game.state.objectMode = false;\\n            if (!game.inInventory(\\\"matchbook\\\")) {\\n                // check for matchbook, exit if not in inventory\\n                game.log.p(\\\"You don't have the means to light a fire.\\\");\\n                return;\\n            }\\n            // update the description of the painting to reflect the fact that it has been burned.\\n            this.description =\\n                \\\"The painting is lying broken upon the floor. It is so badly burned now, that its subject has become indecipherable. What remains of the canvas is a carbonized black. You can't help but think that it is still an improvement compared to the original work.\\\";\\n            game.items._matchbook.closed = false; // matchbook remains open after use, if not already opened.\\n            if (game.state.currentMapCell.hideSecrets) {\\n                // if painting still on wall\\n                this.revealText(\\\"Although the match nearly goes out before you can ignite the painting, a small flame finally finds a foothold on the canvas, and it is soon alarmingly ablaze. Thinking it unwise to burn down the house you are trapped in, you remove the painting from the wall, and stomp out the fire before it can spread any further. \\\\nWhen you look back at the wall that formerly held the burning painting, \\\");\\n                return;\\n            }\\n            // if painting already removed from wall\\n            this.revealText(\\\"Although the match nearly goes out before you can ignite the painting, a small flame finally finds a foothold on the canvas, and it is soon alarmingly ablaze. You are suddenly inspired to end your ill-considered, if brief flirtation with pyromania, and promptly stomp out the fire before they can spread any further.\\\");\\n            return;\\n        },\\n    };\\n}\",\"_pedestal\":\"{\\\"name\\\":\\\"pedestal\\\",\\\"proto\\\":\\\"table\\\",\\\"description\\\":\\\"It is a simple wooden plinth, painted white.\\\"}\",\"_phonograph\":\"(game) => {\\n    return {\\n        name: \\\"phonograph\\\",\\n        description: \\\"The old phonograph has a built-in speaker, and looks like it might still work.\\\",\\n        play() {\\n            if (!game.inEnvironment(\\\"disc\\\") && !game.inInventory(\\\"disc\\\")) {\\n                game.log.p(\\\"First, you will need to find something to play on the phonograph.\\\");\\n                return;\\n            }\\n            return game.items._disc.play.call(this);\\n        },\\n        use() {\\n            this.play.call(this);\\n        },\\n    };\\n}\",\"_photo\":\"(game) => {\\n    return {\\n        name: \\\"photo\\\",\\n        description: \\\"The four by six inch photograph is in a cheap frame made of painted fiberboard. It's a portrait of a very old, and probably infirm black poodle, bluish cataracts clouding its eyes. There is some writing on the back of the frame.\\\",\\n        get reverseDescription() {\\n            return `There is a handwritten inscription on the back of the frame${game.inInventory(this.name)\\n                ? '. It says, \\\"My Precious Muffin\\\\'s 18th Birthday - 10/28/17\\\"'\\n                : \\\"\\\"}.`;\\n        },\\n        points: 3,\\n        text: \\\"My Precious Muffin's 18th Birthday - 10/28/17\\\",\\n        read() {\\n            game.state.objectMode = false;\\n            if (!game.inInventory(this.name)) {\\n                return game.log.p(`You will need to pick up the ${this.name} first.`);\\n            }\\n            game.log.p(`The text on the ${this.name} reads: \\\\n`);\\n            return game.log.cursive(this.text);\\n        },\\n    };\\n}\",\"_projector\":\"(game) => {\\n    return {\\n        name: \\\"projector\\\",\\n        description: \\\"It took you a moment to even recognize the brown plastic box as a film projector. It was designed for consumer use, to display Super 8mm film cartridges of the type that were once used to make home movies in the 1970's.\\\",\\n        play() {\\n            if (!game.inEnvironment(\\\"film\\\") && !game.inInventory(\\\"film\\\")) {\\n                game.log.p(\\\"First, you will need to find something to project with the projector.\\\");\\n                return;\\n            }\\n            if (!game.inEnvironment(\\\"screen\\\") && !game.inInventory(\\\"screen\\\")) {\\n                game.log.p(\\\"You are going to need a screen to project onto.\\\");\\n                return;\\n            }\\n            return game.items._film.play.call(this);\\n        },\\n        use() {\\n            this.play.call(this);\\n        },\\n        project() {\\n            this.play.call(this);\\n        },\\n    };\\n}\",\"_safe\":\"(game) => {\\n    return {\\n        name: \\\"safe\\\",\\n        points: 10,\\n        closed: true,\\n        openable: true,\\n        locked: true,\\n        listed: false,\\n        takeable: false,\\n        solution: \\\"10281999\\\",\\n        description: \\\"The wall safe looks rugged and well-anchored. You doubt that it could be breached by brute force, and it appears to have already successfully weathered a few such attempts. On its face, a numeric keypad resides beneath what looks like a small digital readout.\\\",\\n        contents: [],\\n        containedPart: \\\"_keypad\\\",\\n        correctGuess() {\\n            game.state.objectMode = false;\\n            this.locked = false;\\n            this.closed = false;\\n            game.log.digi(\\\"PASSCODE ACCEPTED.\\\");\\n            game.log.p(\\\"Upon entering the correct passcode, the bolt inside the safe's door slides back, and the door pops open gently.\\\");\\n            if (this.contents.length > 0) {\\n                game.log.p(`Inside the safe is ${game.formatList(this.contents.map((item) => `${item.article} ${item.name}`))}.`);\\n            }\\n        },\\n        incorrectGuess() {\\n            game.state.objectMode = false;\\n            game.log.digi(\\\"PASSCODE INCORRECT\\\");\\n        },\\n        open() {\\n            if (this.locked) {\\n                this.unlock.call(this);\\n            }\\n            else {\\n                Object.getPrototypeOf(this).open.call(this);\\n            }\\n        },\\n        lock() {\\n            game.state.objectMode = false;\\n            this.closed = true;\\n            this.locked = true;\\n            game.log.p(\\\"You lock the wall safe.\\\");\\n        },\\n        unlock() {\\n            game.state.solveMode = true;\\n            game.state.objectMode = false;\\n            if (!this.locked) {\\n                game.log.p(\\\"The safe is already unlocked.\\\");\\n            }\\n            else {\\n                game.log.codeInline([\\n                    `To enter the 8-digit numerical passcode, you must type an underscore `,\\n                    `_`,\\n                    `, followed by the value enclosed in parentheses or backticks.`,\\n                ]);\\n                game.log.codeInline([`For example: `, `_(01234567)`, ` or `, \\\"_`01234567`\\\"]);\\n                game.log.digi(\\\"ENTER PASSCODE:\\\");\\n            }\\n        },\\n        use() {\\n            this.unlock.call(this);\\n        },\\n    };\\n}\",\"_screen\":\"{\\\"name\\\":\\\"screen\\\",\\\"takeable\\\":true,\\\"description\\\":\\\"It is the type of portable movie screen that rolls up into itself like an old window shade.\\\"}\",\"_scroll\":\"(game) => {\\n    return {\\n        name: \\\"scroll\\\",\\n        flammable: true,\\n        points: 10,\\n        description: 'There is some small text, printed on a thin leather strap that was used to bind the rolled up scroll. It says, \\\"rezrov: Open even locked or enchanted objects\\\". As you unfurl the scroll, there appears to be some writing on the inside surface of the parchment, but each line of text seems to disappear as soon as it is revealed.',\\n        text: \\\"rezrov: Open even locked or enchanted objects\\\",\\n        use() {\\n            game.log.p(\\\"You unfurl the scroll and read aloud the text on the inside surface. As you finish, the text fades away, and the scroll disappears! You have memorized \\\\\\\"rezrov\\\\\\\", an incantation capable of opening locked or closed things.\\\");\\n            this.listed = false;\\n        },\\n        cast() {\\n            this.use.call(this);\\n        },\\n    };\\n}\",\"_sink\":\"(game) => {\\n    return {\\n        name: \\\"sink\\\",\\n        listed: false,\\n        description: \\\"It is an old porcelain sink with separate taps for hot and cold water. Like everything else here, it is covered in dust and grime.\\\",\\n        use() {\\n            game.log.p(\\\"You try to turn on the taps, but nothing comes out.\\\");\\n        },\\n    };\\n}\",\"_sofa\":\"(game) => {\\n    return {\\n        name: \\\"sofa\\\",\\n        flammable: true,\\n        listed: false,\\n        description: \\\"The well-worn sitting room sofa is upholstered brown cowhide.\\\",\\n        burn() {\\n            Object.getPrototypeOf(this).burnDown.call(this);\\n        },\\n    };\\n}\",\"_table\":\"{\\\"name\\\":\\\"table\\\",\\\"takeable\\\":false,\\\"listed\\\":false,\\\"description\\\":\\\"The cherrywood dining table is long enough to accomodate at least twenty guests, by your estimation, although you can see only one chair.\\\"}\",\"_toilet\":\"(game) => {\\n    return {\\n        name: \\\"toilet\\\",\\n        listed: false,\\n        description: \\\"You are surprised to find that the bowl of the very old porcelain toilet is still full of water.\\\",\\n        text: \\\"Thomas Crapper & Co.\\\",\\n        flush() {\\n            game.state.objectMode = false;\\n            game.log.p(\\\"Having pushed the lever, and watched the water exit the bowl, you can personally verify that the toilet works as expected.\\\");\\n        },\\n    };\\n}\",\"_wardrobe\":\"(game) => {\\n    return {\\n        name: \\\"wardrobe\\\",\\n        takeable: false,\\n        openable: true,\\n        closed: true,\\n        listed: false,\\n        contents: [],\\n        get description() {\\n            const descriptionString = `The oak wardrobe is roughly four feet wide and seven feet in height and is currently${this.closed ? \\\" closed\\\" : \\\" open\\\"}. `;\\n            if (this.closed) {\\n                return descriptionString;\\n            }\\n            const contentsString = `There is ${this.contents.length < 1\\n                ? \\\"nothing\\\"\\n                : game.formatList(this.contents.map((item) => `${item.article} ${item.name}`))} inside.`;\\n            return descriptionString + contentsString;\\n        },\\n    };\\n}\"}","import initItemProto from \"./Item\";\nimport itemContents from \"./itemContents\";\n// @ts-ignore - rollup-plugin-item-loader:items is a virtual module, created by rollup-plugin-item-loader plugin at build time\nimport items from \"rollup-plugin-item-loader:items\";\nconst eval2 = eval;\nfunction setPrototypes(items, defaultProto) {\n    // first set the prototype of all items to the default prototype\n    for (const itemName in items) {\n        const item = items[itemName];\n        Object.setPrototypeOf(item, defaultProto);\n    }\n    // then set the prototype of items that have a proto property to the item specified in the proto property\n    for (const itemName in items) {\n        const item = items[itemName];\n        if (item.proto) {\n            Object.setPrototypeOf(item, items[`_${item.proto}`]);\n        }\n    }\n}\n// add items to the contents array of other items\nfunction addItemContents(items, contentsObj) {\n    const itemEntries = Object.entries(items);\n    const itemsWithContents = itemEntries.reduce((map, [itemName, item]) => {\n        if (!item.contents) {\n            item.contents = [];\n        }\n        const _itemName = itemName[0] === \"_\" ? itemName : `_${itemName}`;\n        if (_itemName in contentsObj) {\n            const contents = contentsObj[_itemName].map((itemToInclude) => {\n                const _itemToInclude = itemToInclude[0] === \"_\" ? itemToInclude : `_${itemToInclude}`;\n                return items[_itemToInclude];\n            });\n            item.contents.push(...contents);\n        }\n        map[itemName] = item;\n        return map;\n    }, {});\n    return itemsWithContents;\n}\nconst initItems = function (game) {\n    // items is a virtual module, created by rollup-plugin-item-loader plugin at build time. It is an object with keys that are the names of the items, and values that are stringified versions of the item objects and functions. hydrateItems() will parse the strings and functions, and return an object with the hydrated items.\n    const hydrateItems = function (items) {\n        const itemEntries = Object.entries(items);\n        const outputItems = itemEntries.reduce((map, [itemName, item]) => {\n            map[itemName] = item;\n            try {\n                if (typeof item === \"string\") {\n                    map[itemName] = eval2(item);\n                }\n                if (typeof map[itemName] === \"function\") {\n                    map[itemName] = map[itemName](game);\n                }\n            }\n            catch (err) {\n                try {\n                    if (typeof item === \"string\") {\n                        map[itemName] = JSON.parse(item);\n                    }\n                }\n                catch (err) {\n                    map[itemName] = item;\n                }\n            }\n            return map;\n        }, {});\n        return outputItems;\n    };\n    const hydratedItems = hydrateItems(items);\n    game.items = hydratedItems;\n    const ItemProto = initItemProto(game);\n    setPrototypes(hydratedItems, ItemProto);\n    const itemsWithContents = addItemContents(hydratedItems, itemContents);\n    return itemsWithContents;\n};\nexport default initItems;\n//# sourceMappingURL=index.js.map","export default function initItemProto(game) {\n    return {\n        name: \"Item\",\n        used: false,\n        weight: 1,\n        get description() {\n            return `There is nothing particularly interesting about the ${this.name}.`;\n        },\n        reverseDescription: null,\n        takeable: true,\n        openable: false,\n        flammable: false,\n        activated: false,\n        closed: false,\n        locked: false,\n        article: \"a\",\n        listed: true,\n        solution: null,\n        points: 1,\n        count: 0,\n        proto: null,\n        contents: [],\n        unlockedBy: null,\n        lockedTarget: null,\n        closedTarget: null,\n        containedPart: null,\n        text: null,\n        get lightCount() {\n            return this.activated ? this.count : 0;\n        },\n        burn: function () {\n            game.state.objectMode = false;\n            if (!game.inInventory(\"matchbook\")) {\n                game.log.p(\"You don't have the means to light a fire.\");\n            }\n            else {\n                game.items._matchbook.closed = false;\n                if (!this.flammable) {\n                    game.log.p(`The meager flame is inadequate to ignite the ${this.name}.`);\n                }\n                else {\n                    game.log.p(`The match's flame proves to be enough to ignite the ${this.name}. You watch as the ${this.name} is quickly transformed into little more than a pile of ash.`);\n                    if (game.inEnvironment(this.name)) {\n                        game.state.currentMapCell.removeFromEnv(this);\n                    }\n                    else if (game.inInventory(this.name)) {\n                        game.removeFromInventory(this);\n                    }\n                }\n            }\n        },\n        burnDown: function () {\n            Object.getPrototypeOf(this).burn.call(this);\n            game.dead(`Unsatisfied after having consumed the ${this.name}, the fire quickly moves on to bigger and better things, like turning you and the house you are trapped in to a pile of smoldering embers.`);\n        },\n        climb: function () {\n            game.state.objectMode = false;\n            game.log.p(`You attempt to scale the ${this.name}, but quickly slip, landing painfully on your back. That was pointless.`);\n        },\n        close: function () {\n            game.state.objectMode = false;\n            if (!game.inEnvironment(this.name) && !game.inInventory(this.name)) {\n                game.log.p(`You don't see ${this.article} ${this.name} here.`);\n            }\n            else if (!this.openable) {\n                game.log.p(\"It cannot be closed.\");\n            }\n            else if (this.closed) {\n                game.log.p(\"It is already closed.\");\n            }\n            else {\n                game.log.p(`The ${this.name} is now closed.`);\n                this.closed = true;\n                if (this.closedTarget) {\n                    game.mapKey[this.closedTarget].closed = true;\n                }\n                if (this.containedPart) {\n                    game.items[this.containedPart].closed = true;\n                }\n            }\n        },\n        correctGuess: function () { },\n        incorrectGuess: function () { },\n        decrementCounter: function () {\n            if (this.lightCount === 1 && game.inInventory(this.name)) {\n                game.log.p(`The light from the ${this.name} fades.`);\n            }\n            this.count = Math.max(this.count - 1, 0);\n        },\n        drink: function () {\n            game.state.objectMode = false;\n            game.log.p(`You cannot drink the ${this.name}.`);\n        },\n        drop: function () {\n            game.state.objectMode = false;\n            if (game.inInventory(this.name)) {\n                game.removeFromInventory(this);\n                game.state.score -= this.points;\n                game.state.currentMapCell.visibleEnv.push(this);\n                game.log.p(`${this.name} dropped.`);\n            }\n            else {\n                game.log.p(\"You don't have that.\");\n            }\n        },\n        eat: function () {\n            game.state.objectMode = false;\n            game.log.p(`You cannot eat the ${this.name}.`);\n        },\n        examine: function () {\n            game.state.objectMode = false;\n            game.log.p(this.description);\n            if (this.activated && this.lightCount > 0) {\n                game.log.p(\"Its glow illuminates the darkness.\");\n            }\n        },\n        extinguish: function () {\n            game.state.objectMode = false;\n            if (this.lightCount > 0) {\n                this.activated = false;\n                game.log.p(`You extinguish the ${this.name}.`);\n            }\n            else {\n                game.log.p(`The ${this.name} is not lit.`);\n            }\n        },\n        flush: function () {\n            game.state.objectMode = false;\n        },\n        frotz: function () {\n            game.state.objectMode = false;\n            this.activated = true;\n            this.count = 3;\n            game.log.p(`Upon uttering the magic word, there is a flash, and then the ${this.name} begins to glow!`);\n        },\n        lock: function () {\n            game.state.objectMode = false;\n            if (this.locked) {\n                game.log.p(`The ${this.name} is already locked.`);\n            }\n            else if (this.unlockedBy && game.inInventory(this.unlockedBy)) {\n                this.locked = true;\n                game.log.p(`Using the ${this.unlockedBy}, you lock the ${this.name}`);\n                if (this.lockedTarget) {\n                    game.mapKey[this.lockedTarget].locked = true;\n                }\n            }\n            else {\n                game.log.p(`You do not have the means to lock the ${this.name}.`);\n            }\n        },\n        move: function () {\n            game.log.p(`You cannot move the ${this.name}`);\n        },\n        open: function () {\n            game.state.objectMode = false;\n            if (!game.inEnvironment(this.name) && !game.inInventory(this.name)) {\n                game.log.p(`You don't see ${this.article} ${this.name} here.`);\n            }\n            else if (!this.openable) {\n                game.log.p(\"It cannot be opened.\");\n            }\n            else if (!this.closed) {\n                game.log.p(\"It is already open.\");\n            }\n            else if (this.locked) {\n                game.log.p(\"It appears to be locked.\");\n            }\n            else {\n                game.log.p(`The ${this.name} is now open.`);\n                this.closed = false;\n                game.state.score += this.points;\n                this.points = 0; // ? why is this here?\n                if (this.closedTarget) {\n                    game.mapKey[this.closedTarget].closed = false;\n                }\n                if (this.containedPart) {\n                    game.items[this.containedPart].closed = false;\n                }\n            }\n        },\n        read: function () {\n            game.state.objectMode = false;\n            if (!this.text) {\n                game.log.p(\"There is nothing to read.\");\n            }\n            else if (!game.inInventory(this.name)) {\n                game.log.p(`You will need to pick up the ${this.name} first.`);\n            }\n            else {\n                game.log.p(`The text on the ${this.name} reads: \\n`);\n                game.log.note(this.text);\n            }\n        },\n        rezrov: function () {\n            game.state.objectMode = false;\n            if (!game.inInventory(\"scroll\") && !game.inEnvironment(\"scroll\")) {\n                game.log.p(\"You are incapable of wielding such powerful magic unassisted.\");\n            }\n            else {\n                if (this.locked || this.closed) {\n                    game.log.p('Once the rezrov spell is cast, the magic scroll disappears with a sudden flash, and a loud \"WHOMP!\"');\n                    game.log.p(`When the smoke has cleared, the ${this.name} has been magically unlocked and opened!`);\n                    if (this.locked) {\n                        this.locked = false;\n                        if (this.lockedTarget) {\n                            game.mapKey[this.lockedTarget].locked = false;\n                        }\n                        game.log.p(`The ${this.name} is now unlocked.`);\n                    }\n                    if (this.closed) {\n                        this.closed = false;\n                        if (this.closedTarget) {\n                            game.mapKey[this.closedTarget].closed = false;\n                        }\n                        game.log.p(`The ${this.name} is now open.`);\n                    }\n                    if (game.inInventory(\"scroll\")) {\n                        game.removeFromInventory(game.items._scroll);\n                    }\n                    else if (game.inEnvironment(\"scroll\")) {\n                        game.state.currentMapCell.removeFromEnv(game.items._scroll);\n                    }\n                }\n                else {\n                    game.log.p(\"The rezrov spell has no effect.\");\n                }\n            }\n        },\n        take: function () {\n            game.state.objectMode = false;\n            if (this.takeable) { //&& game.inEnvironment(this.name) ) {\n                game.addToInventory([this]);\n                game.state.score += this.points;\n                game.state.currentMapCell.removeFromEnv(this);\n                game.log.p(`You pick up the ${this.name}.`);\n            }\n            else {\n                game.log.p(`You cannot take the ${this.name}.`);\n            }\n        },\n        takeComponent: function () {\n            const realItem = Object.getPrototypeOf(this);\n            if (!this.takeable || !game.inEnvironment(this.name)) {\n                game.log.p(`You can't take that.`);\n            }\n            game.addToInventory([this]);\n            game.state.currentMapCell.removeFromEnv(this);\n            realItem.take.call(realItem);\n        },\n        turn: function () {\n            game.state.objectMode = false;\n            game.log.p(this.reverseDescription\n                ? this.reverseDescription\n                : `Turning the ${this.name} has no noticeable effect.`);\n        },\n        unlock: function () {\n            game.state.objectMode = false;\n            if (!this.locked) {\n                game.log.p(`The ${this.name} is not locked.`);\n                return;\n            }\n            else if (this.unlockedBy && game.inInventory(this.unlockedBy)) {\n                this.locked = false;\n                game.log.p(`Using the ${this.unlockedBy}, you are able to unlock the ${this.name}`);\n                if (this.lockedTarget) {\n                    game.mapKey[this.lockedTarget].locked = false;\n                }\n            }\n            else {\n                game.log.p(`You do not have the means to unlock the ${this.name}.`);\n            }\n        },\n        use: function () {\n            game.state.objectMode = false;\n            game.log.p(`Try as you might, you cannot manage to use the ${this.name}`);\n        },\n    };\n}\n//# sourceMappingURL=Item.js.map","import MapCell from \"./MapCell\";\nimport { formatList } from \"../utils/helpers\";\nconst mapKey = function (game) {\n    // Prototype definition for a single cell on the map grid (usually a room)\n    const MapCellProto = MapCell(game);\n    const setMapCellPrototypes = (mapKey, proto = MapCellProto) => {\n        Object.keys(mapKey).forEach((cell) => {\n            Object.setPrototypeOf(mapkey[cell], proto);\n        });\n    };\n    const stockDungeon = (mapKey) => {\n        Object.keys(mapKey).forEach((key) => {\n            const subEnvNames = Object.keys(mapKey[key]).filter(keyName => keyName.toLowerCase().includes(\"env\"));\n            for (const subEnvName of subEnvNames) {\n                let roomEnv = mapKey[key][subEnvName];\n                let newEnv = [];\n                if (roomEnv.length) {\n                    roomEnv.forEach((item) => {\n                        let itemObj = typeof item === \"string\" ? game.items[`_${item}`] : item;\n                        if (itemObj) {\n                            newEnv.push(itemObj);\n                        }\n                        else {\n                            console.log(`Cannot stock ${item}. No such item.`);\n                        }\n                    });\n                }\n                mapKey[key][subEnvName] = newEnv;\n            }\n        });\n    };\n    const mapkey = {\n        \"0\": {\n            locked: true,\n            lockText: \"An attempt has been made to board up this door. Reaching between the unevenly spaced boards, you try the doorknob and discover that it is also locked.\",\n        },\n        A: {\n            name: \"Freedom!\",\n            locked: false,\n            closed: true,\n            get lockText() {\n                return `The formidable wooden front door will not open. It looks as old as the rest of the building, and like the wood panelled walls of the entrance hall, it is dark with countless layers of murky varnish. It is ${this.locked ? \"locked\" : \"unlocked\"}.`;\n            },\n            get description() {\n                if (game.state.turn < 3) {\n                    game.captured();\n                    return game.variableWidthDivider();\n                }\n                game.state.score += 50;\n                game.winner(\"\\nYou have escaped!\\n\");\n                return game.variableWidthDivider();\n            },\n        },\n        a: {\n            name: \"Freedom!\",\n            locked: true,\n            closed: true,\n            get lockText() {\n                return `The kitchen door will not open. It is ${this.locked ? \"locked\" : \"unlocked\"}.`;\n            },\n            get description() {\n                if (game.state.turn < 3) {\n                    game.captured();\n                    return \"\";\n                }\n                return game.winner(\"\\nYou have escaped!\\n\");\n            },\n        },\n        B: {\n            name: \"Basement\",\n            description: \"A single dim bulb, dangling on a cord from the low, unfinished ceiling, is barely enough to illuminate the room. The floors appear to be composed of compressed earth, left unfinished since the space was initially excavated more than a century ago.  \",\n            smell: \"It smells strongly of old, damp basement – a mix of dirt and mildew with perhaps a hint of rodent feces.\",\n            get sound() {\n                return `You can hear a dog barking. The sound is emanating from the room north of you. It is loud enough now for you to recognize it as ${game.state.dogName}'s bark!`;\n            },\n        },\n        C: {\n            name: \"Dark room\",\n            hiddenSecrets: true,\n            get des1() {\n                return `As you walk into the dark room, it feels as if the increasingly uneven floor is sloping downward, though you can see nothing. \\nIt is pitch black. You are likely to be eaten by a grue. \\nSomewhere in the dark, you can hear ${game.state.dogName} barking excitedly!`;\n            },\n            get des2() {\n                return `By the flickering light of the flame, you can see that the floor becomes rougher and more irregular, sloping down toward the north.`;\n            },\n            smell: \"It smells strongly of old, damp dungeon – a mix of dirt and mildew with perhaps a hint of grue feces.\",\n            get description() {\n                // @ts-ignore - this property will be available when the object's prototype is set later\n                return this.hideSecrets ? this.des1 : this.des2;\n            },\n            hiddenEnv: [\"lantern\", \"basement_door\"],\n            visibleEnv: [\"grue\"],\n        },\n        D: {\n            name: \"Bathroom\",\n            description: \"The bathroom is tiled with hundreds of tiny, white, hexagonal tiles. It features the usual bathroom amenities, like a sink, a tub and a commode.\",\n            visibleEnv: [\"sink\", \"bathtub\", \"toilet\", \"knife\"],\n        },\n        E: {\n            name: \"Guest Room\",\n            description: \"The guest room is modestly furnished, with little more than a small bed and a dresser.\",\n            visibleEnv: [\"bed\", \"dresser\", \"dresser_drawer\"],\n        },\n        F: {\n            name: \"Sitting room\",\n            description: \"A small sitting room adjoins the master bedroom. It contains a cushioned armchair and a small sofa, both facing a coffee table.\",\n            visibleEnv: [\"chair\", \"sofa\", \"coffee_table\", \"photo\"],\n        },\n        G: {\n            name: \"Master bedroom\",\n            get description() {\n                return `The master bedroom is spacious though sparsely furnished, containing only a bedframe, a wardrobe and a nightstand`;\n            },\n            visibleEnv: [\"bed\", \"nightstand\", \"nightstand_drawer\", \"wardrobe\"],\n        },\n        H: {\n            name: \"Master bathroom\",\n            description: \"The bathroom adjoining the bedroom has all of the expected fixtures, though they are corroded and covered in filth. \",\n            visibleEnv: [\"toilet\", \"sink\", \"bathtub\"],\n        },\n        I: {\n            name: \"Cell\",\n            description: \"It is a dark and scary cell.\",\n            locked: true,\n            closed: true,\n            smell: \"It smells like dog waste.\",\n            get lockText() {\n                return `An ominous-looking, rusted steel door blocks your path. It is ${this.locked ? \"locked\" : \"unlocked\"}.`;\n            },\n            visibleEnv: [\"dog\"],\n        },\n        J: {\n            name: \"Parlor\",\n            get description() {\n                return `This room looks like it was used to screen films and recordings. There is a tall white pedestal${game.inEnvironment(\"projector\")\n                    ? \", supporting a squarish plastic Super 8 projector,\"\n                    : \"\"} in the center of the room. `;\n            },\n            visibleEnv: [\"projector\", \"screen\", \"pedestal\", \"chair\", \"phonograph\"],\n        },\n        \"^\": {\n            name: \"Second floor hallway, north\",\n            description: \"You are at the top of a wide wooden staircase, on the second floor of the old house.\",\n            visibleEnv: [],\n        },\n        \"-\": {\n            name: \"Second floor hallway, south\",\n            description: \"It looks like there are a couple of rooms on either side of the broad hallway, and a small broom closet at the south end.\",\n            visibleEnv: [],\n        },\n        \"+\": {\n            name: \"Study\",\n            visibleDescription: \"The walls of the dark, wood-panelled study are lined with bookshelves, containing countless dusty tomes. Behind an imposing walnut desk is a tall-backed desk chair.\",\n            smell: \"The pleasantly musty smell of old books emanates from the bookshelves that line the wall.\",\n            hideSecrets: true,\n            visibleEnv: [\n                \"desk\",\n                \"painting\",\n                \"chair\",\n                \"bookshelves\",\n                \"books\",\n                \"drawer\",\n                \"booklet\",\n            ],\n            hiddenEnv: [\"safe\", \"keypad\"],\n            hiddenDescription: \"In space where a painting formerly hung there is a small alcove housing a wall safe.\",\n            get description() {\n                if (this.hideSecrets) {\n                    return (this.visibleDescription +\n                        \"\\n\" +\n                        \"On the wall behind the chair hangs an ornately framed painting.\");\n                }\n                return this.visibleDescription + \"\\n\" + \"\\n\" + this.hiddenDescription;\n            },\n        },\n        \"#\": {\n            name: \"Staircase landing\",\n            description: \"You are on the landing of a worn oak staircase connecting the first and second floors of the old abandoned house.\",\n            visibleEnv: [],\n        },\n        \"%\": {\n            name: \"Entrance hall, south\",\n            description: \"You are in the main entrance hall of a seemingly abandoned house. There are two doors on either side of the hall. The front door is to the south. At the north end of the hall is a wide oak staircase that connects the first and second floors of the old house.\",\n            visibleEnv: [\"door\", \"note\"],\n        },\n        \"=\": {\n            name: \"Entrance hall, north\",\n            description: \"You are in the main entrance hall of a seemingly abandoned house. There are two doors on either side of the hall. The front door is to the south. At the rear of the hall is a wide oak staircase that connects the first and second floors of the old house.\",\n            visibleEnv: [],\n        },\n        \"@\": {\n            name: \"Stone staircase, top\",\n            description: \"You are at the top of a stone staircase that leads down to the basement. A faint cold draft greets you from below.\",\n            smell: \"A vaguely unfresh scent wafts up from the basement.\",\n            visibleEnv: [\"collar\"],\n            sound: \"You do not hear anything.\",\n        },\n        \"(\": {\n            name: \"Stone staircase, landing\",\n            description: \"You are standing on a stone staircase leading to the basement. A faint cold draft greets you from below.\",\n            smell: \"As you descend, the smell of mildew and earth becomes noticeable.\",\n            sound: \"For a moment, you are certain you can hear what sounds like muffled barking, but when you stop moving and strain to hear it again, the sound has stopped.\",\n        },\n        \")\": {\n            name: \"Stone staircase, bottom\",\n            description: \"You are standing on a stone staircase leading upwards to the first floor.\",\n            smell: \"It smells strongly of old, damp basement – a mix of dirt and mildew with perhaps a hint of rodent feces.\",\n            sound: \"You can definitely hear the sound of distant, muffled barking. It is coming from the east!\",\n        },\n        $: {\n            name: \"Broom closet\",\n            hiddenSecrets: true,\n            hiddenEnv: [\"glove\"],\n            visibleEnv: [\"chain\"],\n            des1: \"The small closet is dark, although you can see a small chain hanging in front of you.\",\n            get des2() {\n                const hidden = this.hiddenEnv;\n                const text = \"The inside of this small broom closet is devoid of brooms, or much of anything else, for that matter\";\n                const plural = hidden.length > 1 ? \"y\" : \"ies\";\n                return (text +\n                    (hidden.length\n                        ? `, with the exception of ${formatList(hidden.map((item) => {\n                            // @ts-ignore - when game is initialized, the stockDungeon method will replace the name of the item with the actual item object\n                            return `${item.article} ${item.name}`;\n                        }))} which occup${plural} a dusty corner.`\n                        : \".\"));\n            },\n            get description() {\n                // @ts-ignore - this property will be available when the object's prototype is set later\n                return this.hideSecrets ? this.des1 : this.des2;\n            },\n        },\n        X: {\n            name: \"Dining room\",\n            visibleEnv: [\"chair\", \"table\"],\n            description: \"A long cherry dining table runs the length of this formal dining room.\",\n        },\n        Z: {\n            name: \"Kitchen\",\n            visibleEnv: [\"maps\", \"backdoor\"],\n            description: \"It is quite large for a residential kitchen. While only a few of the original appliances remain, gritty outlines on the walls and floor suggest it was once well appointed. Now it is an echoing tile cavern.\",\n            smell: \"It smells like a dusty abandoned building. And chicken soup.\",\n        },\n    };\n    // every cell defined in mapkey will inherit from MapCellProto\n    setMapCellPrototypes(mapkey);\n    // replace the name of each item with the actual item object\n    stockDungeon(mapkey);\n    return mapkey;\n};\nexport default mapKey;\n//# sourceMappingURL=mapKey.js.map","import { primaryFont } from \"./utils/prefs\";\n// This object contains most of the text that is displayed to the user. Each key is a string to be is referenced by a game method. Each value is either a string, an array of strings, or a function that returns a string. The function is passed the game object as an argument, so that it can access the current state of the game, and the log methods.\nconst descriptions = {\n    preface: \"You slowly open your eyes. Your eyelids aren't halfway open before the throbbing pain in your head asserts itself. The last thing you can remember is taking your dog for a walk. Your current surroundings look entirely unfamiliar.\",\n    intro: (game) => {\n        const intro_1 = \"\\nWelcome!\\nAs a fan of old Infocom™ interactive fiction games, I thought it would be fun to hide a text adventure in the browser's JavaScript console. Try it out by typing in the console below. Have fun!\\n\";\n        game.log.title(\"consoleGame\");\n        game.log.custom(\"by Dennis Hodges\\ncopyright 2019-2023\", \"font-size:100%;color:lightgray;padding:0 1em;\");\n        game.log.intro(intro_1);\n        game.log.codeInline(descriptions.introOptions(game));\n    },\n    introOptions: (game) => {\n        const existingGame = [\n            \"[ It looks like you have an unsaved game in progress from a previous session. If you would like to continue, type \",\n            \"resume\",\n            \". If you would like to load a saved game, type \",\n            \"restore\",\n            \". To begin a new game, please type \",\n            \"start\",\n            \". ]\"\n        ];\n        const initialOptions = [\n            \"[ Please type \",\n            \"help \",\n            \"for instructions, \",\n            \"restore \",\n            \"to load a saved game, or \",\n            \"start \",\n            \"to begin a new game. ]\"\n        ];\n        return game.unfinishedGame() ? existingGame : initialOptions;\n    },\n    captured: [\"As you step out onto the front porch, you struggle to see in the bright midday sun, your eyes having adjusted to the dimly lit interior of the house. You hear a surprised voice say, \\\"Hey! How did you get out here?!\\\" You spin around to see the source of the voice, but something blunt and heavy has other plans for you and your still aching skull. You descend back into the darkness of sleep.\", \"Groggily, you lift yourself from the floor, your hands probing the fresh bump on the back of your head.\"],\n    winner: (game, additionalText) => {\n        if (additionalText) {\n            game.log.win(additionalText);\n        }\n        game.log.win(\"You win!! Congratulations and thanks for playing!\");\n    },\n    gameOver: (game) => game.log.codeInline([\"[Game over. Please type \", \"start \", \"to begin a new game.]\"]),\n    dead: \"You have died. Of course, being dead, you are unaware of this unfortunate turn of events.\",\n    help: (game) => {\n        // Greeting to be displayed at the beginning of the game\n        const baseStyle = `font-family:${primaryFont};color:pink;font-size:105%;line-height:1.5;`;\n        const italicCodeStyle = \"font-family:courier;color:#29E616;font-size:115%;font-style:italic;line-height:2;\";\n        const codeStyle = \"font-family:courier;color:#29E616;font-size:115%;line-height:1.5;\";\n        const text = [\"Valid commands are one word long, with no spaces. Compound commands consist of at most two commands, separated by a carriage return or a semicolon. For example:\\n\", \"get\\n\", \"What would you like to take?\\n\", \"lamp\\n\", \"You pick up the lamp.\\n\", \"or,\\n\", \"get;lamp\\n\", \"What would you like to take?\\nYou pick up the lamp.\"];\n        const styles = [baseStyle, codeStyle, italicCodeStyle, codeStyle, italicCodeStyle, baseStyle, codeStyle, italicCodeStyle];\n        game.log.inline(text, styles);\n        const text_2 = [\"Typing \", \"inventory \", \"or \", \"i \", \"will display a list of any items the player is carrying. \\nTyping \", \"look \", \"or \", \"l \", \"will give you a description of your current environs in the game. \\nCommands with prepositions are not presently supported, and \", \"look \", \"can only be used to \\\"look around\\\", and not to \\\"look at\\\" something. Please instead use \", \"examine \", \"or its shortcut \", \"x \", \"to investigate an item's properties. \\nThe player may move in the cardinal directions– \", \"north\", \", \", \"south\", \", \", \"east\", \" and \", \"west \", \"as well as \", \"up \", \"and \", \"down. \", \"Simply type the direction you want to move. These may be abbreviated as \", \"n\", \", \", \"s\", \", \", \"e\", \", \", \"w\", \", \", \"u \", \"and \", \"d \", \", respectively.\"];\n        game.log.codeInline(text_2, baseStyle, codeStyle);\n        const text_3 = [\"You may save your game progress (it will be saved to localStorage) by typing \", \"save\", \". You will then be asked to select a save slot, \", \"_0 \", \"through \", \"_9 \", \"(remember, user input can't begin with a number). Typing \", \"help \", \"will display the in-game help text.\"];\n        game.log.codeInline(text_3, baseStyle, codeStyle);\n        game.log.codeInline(descriptions.introOptions(game));\n    },\n    restore: (game, slotList) => {\n        game.log.codeInline([\"saved games:\\n\", slotList]);\n        game.log.codeInline([\"Please choose which slot number (0 through 9) to restore from. To restore, type an underscore, \", \"_ \", \"immediately followed by the slot number.\"]);\n        const exampleSlot = slotList[0] || \"_0\";\n        game.log.codeInline([`For example, type `, exampleSlot, ` to select slot ${exampleSlot.slice(1)}.`]);\n    },\n    save: (game) => {\n        game.log.codeInline([\"Please choose a slot number (0 through 9) to save your game. To save to the selected slot, type an underscore, \", \"_\", \" immediately followed by the slot number.\"]);\n        game.log.codeInline([`For example, type `, `_3`, ` to select slot 3.`]);\n    },\n    doorLock: \"You hear a short metallic scraping sound, ending in a click. It sounds like the front door being locked from the outside.\",\n};\nexport default descriptions;\n//# sourceMappingURL=descriptions.js.map","import descriptions from \"./descriptions\";\nexport default [\n    // Timers\n    // Front door lock timer\n    (game) => {\n        if (game.state.turn === 2 && !game.items._door.locked) {\n            game.displayText(descriptions.doorLock);\n            game.items._door.closed = true;\n            game.items._door.locked = true;\n            game.mapKey[game.items._door.lockedTarget].locked = true;\n            game.mapKey[game.items._door.closedTarget].closed = true;\n        }\n    },\n    // Main game timer\n    (game) => {\n        if (game.state.turn >= game.timeLimit && !game.state.gameOver) {\n            return game.dead(\"You don't feel so well. It never occurs to you, as you crumple to the ground, losing consciousness for the final time, that you have been poisoned by an odorless, invisible, yet highly toxic gas.\");\n        }\n    },\n    // Lightsource timer\n    (game) => {\n        game.lightSources.forEach((source) => source.decrementCounter());\n    },\n    // Grue timer\n    (game) => {\n        if (game.inEnvironment(\"grue\")) {\n            game.items._grue.lurk();\n        }\n    },\n];\n//# sourceMappingURL=initialTimers.js.map","import initialTimers from \"./initialTimers\";\n// commands that are not saved to history and do not count as a turn\nconst EXEMPT_COMMANDS = [\n    \"help\",\n    \"start\",\n    \"commands\",\n    \"inventory\",\n    \"inventorytable\",\n    \"look\",\n    \"font\",\n    \"color\",\n    \"size\",\n    \"save\",\n    \"restore\",\n    \"resume\",\n    \"verbose\",\n    \"quit\",\n    \"again\",\n    \"yes\",\n    \"score\",\n    \"_0\",\n    \"_1\",\n    \"_2\",\n    \"_3\",\n    \"_4\",\n    \"_5\",\n    \"_6\",\n    \"_7\",\n    \"_8\",\n    \"_9\",\n    \"poof\",\n];\nexport default class TurnDaemon {\n    constructor(game) {\n        this.timers = [];\n        this.game = game;\n        initialTimers.forEach((timer, index) => {\n            this.registerTimer(`timer_${index}`, timer);\n        });\n        this.executeCommand = this.executeCommand.bind(this);\n        this.registerTimer = this.registerTimer.bind(this);\n        this.removeTimer = this.removeTimer.bind(this);\n        this.runTimers = this.runTimers.bind(this);\n    }\n    // This function is bound to each command, and is called when the command is executed\n    executeCommand(commandName, interpreterFunction) {\n        const window = globalThis;\n        if (this.game.state.gameOver) {\n            if (commandName === \"start\") {\n                this.game.start();\n                return this.game.variableWidthDivider();\n            }\n            this.game.displayText(this.game.descriptions.gameOver);\n        }\n        else {\n            if (window.CONSOLE_GAME_DEBUG) {\n                window.debugLog.push({ userInput: commandName });\n            }\n            try {\n                // execute command\n                interpreterFunction(commandName);\n                if (!EXEMPT_COMMANDS.includes(commandName)) {\n                    // don't add to history or increment turn or timers if command is exempt\n                    this.game.addToHistory(commandName);\n                    if (!this.game.state.objectMode && !this.game.state.abortMode) {\n                        // only increment turn and timers if not in objectMode (prevents two-word commands from taking up two turns), and if not in abortMode (prevent a failed movement attempt, i.e. trying to move 'up' when you are only able to move 'east' or 'west', from consuming a turn)\n                        this.runTimers();\n                        this.game.state.turn++;\n                    }\n                    this.game.state.abortMode = false;\n                    if (this.game.state.verbose) {\n                        this.game.describeSurroundings();\n                    }\n                }\n                // to avoid printing 'undefined' when a command returns nothing\n                return this.game.variableWidthDivider();\n            }\n            catch (error) {\n                // recognized command word used incorrectly\n                console.trace(error);\n                this.game.log.p(\"That's not going to work. Please try something else.\");\n                // to avoid printing 'undefined' when a command returns nothing\n                return this.game.variableWidthDivider();\n            }\n        }\n    }\n    // executes all timer functions\n    runTimers() {\n        this.timers.forEach((timer) => {\n            timer.function(this.game);\n        });\n    }\n    // registers a timer function\n    registerTimer(name, timerFunction) {\n        this.timers.push({ name, function: timerFunction });\n    }\n    // removes a timer function\n    removeTimer(timerToRemove) {\n        if (typeof timerToRemove === \"string\") {\n            this.timers = this.timers.filter((timer) => timer.name !== timerToRemove);\n        }\n        else {\n            this.timers = this.timers.filter((timer) => timer.function !== timerToRemove);\n        }\n    }\n    // checks if a timer function is registered\n    hasTimer(timerToCheck) {\n        if (typeof timerToCheck === \"string\") {\n            return this.timers.some((timer) => timer.name === timerToCheck);\n        }\n        else {\n            return this.timers.some((timer) => timer.function === timerToCheck);\n        }\n    }\n}\n//# sourceMappingURL=TurnDaemon.js.map","// commands that are reserved words in JavaScript but we will overwrite anyway, (;\nconst RESERVED_WORDS_TO_OVERWRITE = [\n    \"open\",\n    \"close\",\n    \"status\",\n    \"inspect\",\n    \"table\",\n    \"screen\",\n    \"scroll\",\n];\nexport default class CommandBinder {\n    constructor(game) {\n        this.game = game;\n        this.bindCommandToFunction = this.bindCommandToFunction.bind(this);\n        this.bindCommands = this.bindCommands.bind(this);\n    }\n    /*\n  *bindCommandToFunction() creates a property on the global object with the command name (and one for each related alias), and binds the function to be invoked to a getter method on the property.\n  This is what allows functions to be invoked by the player in the console without needing to type the invocation operator \"()\" after the name.\n  Thank you to secretGeek for this clever solution. I found it here: https://github.com/secretGeek/console-adventure. You can play his console adventure here: https://rawgit.com/secretGeek/console-adventure/master/log.html\n  */\n    bindCommandToFunction(interpreterFunction, // The function to be (eventually) invoked when the command is entered\n    commandAliases, daemon // A function that will be invoked with the command name and the interpreter function as arguments.\n    ) {\n        const aliasArray = commandAliases.split(\",\");\n        // Use the first alias as the command name\n        const [commandName] = aliasArray;\n        // If a daemon function is provided, it will be invoked with the command name and the interpreter function as arguments. Otherwise, the interpreter function will be invoked with the command name as an argument.\n        const interpretCommand = daemon\n            ? daemon.bind(this.game, commandName, interpreterFunction.bind(this.game))\n            : interpreterFunction.bind(this.game, commandName);\n        try {\n            aliasArray.forEach((alias) => {\n                // check to prevent unwanted overwrite of global property, i.e. Map\n                if (!(alias in globalThis) ||\n                    RESERVED_WORDS_TO_OVERWRITE.includes(alias)) {\n                    // The following (commented-out) line was causing a bug, so do not revert to it.\n                    // Object.defineProperty(globalThis, alias.trim(), {get: interpretCommand});\n                    Object.defineProperty(globalThis, alias.trim(), {\n                        get() {\n                            return interpretCommand();\n                        },\n                    });\n                }\n            });\n        }\n        catch (err) {\n            // fail silently\n        }\n    }\n    // Applies bindCommandToFunction() to an array of all of the commands to be created\n    bindCommands(commands) {\n        commands.forEach((commandEntry) => {\n            var _a;\n            let [interpreterFunction, aliases] = commandEntry;\n            this.bindCommandToFunction(interpreterFunction, aliases, (_a = this.game.turnDaemon) === null || _a === void 0 ? void 0 : _a.executeCommand);\n        });\n    }\n}\n//# sourceMappingURL=CommandBinder.js.map","import storage from \"./utils/storage\";\nimport log from \"./utils/customConsole/index\";\nimport { randomDogName } from \"./utils/dogNames\";\nimport initCommandModule from \"./commands\";\nimport initItemsModule from \"./items/index\";\nimport initMapKeyModule from \"./maps/mapKey\";\nimport maps from \"./maps/maps\";\nimport descriptions from \"./descriptions\";\nimport { deepClone, formatList, cases, aliasString, cropFloorMap, } from \"./utils/helpers\";\nimport thesaurus from \"./utils/thesaurus\";\nimport TurnDaemon from \"./TurnDaemon\";\nimport CommandBinder from \"./CommandBinder\";\nconst { getStorage, removeStorage, setStorage } = storage;\nlet gameContext;\nexport default class Game {\n    constructor() {\n        this.state = {};\n        this.maps = [];\n        this.mapKey = {};\n        this.items = {};\n        this.commands = {};\n        this.commandList = [];\n        this.timeLimit = 300;\n        this.log = log;\n        this.confirmationCallback = () => { };\n        this.lightSources = [];\n        this.descriptions = {};\n        this.turnDaemon = null;\n        this.commandBinder = null;\n        this.initialState = {\n            solveMode: false,\n            prefMode: false,\n            restoreMode: false,\n            gameOver: false,\n            pendingAction: null,\n            turn: 0,\n            score: 0,\n            dogName: null,\n            inventory: [],\n            startPosition: {\n                z: 3,\n                y: 13,\n                x: 7,\n            },\n            position: {\n                z: 3,\n                y: 13,\n                x: 7,\n            },\n            history: [],\n            get currentCellCode() {\n                return gameContext.maps[this.position.z][this.position.y][this.position.x];\n            },\n            get currentMapCell() {\n                return gameContext.mapKey[this.currentCellCode];\n            },\n            get env() {\n                return this.currentMapCell.env;\n            },\n            get combinedEnv() {\n                return Object.values(this.env).flat();\n            },\n        };\n        const window = globalThis;\n        // gameContext is used to make `this` available from inside `this.state` getters\n        gameContext = this;\n        // make the setValue function available to the game. It should not be bound to a command name, like the other commands, because it needs to be invoked with arguments.\n        window._ = this.setValue.bind(this);\n        window.debugLog = [];\n        // enable \"start\" and other essential commands\n        this.descriptions = descriptions;\n        this.turnDaemon = new TurnDaemon(this);\n        this.commandBinder = new CommandBinder(this);\n        this.bindInitialCommands();\n        this.log.tiny(\"Game initialized.\");\n    }\n    /**\n     * =====================\n     * Initialization methods\n     * =====================\n     */\n    // bindInitialCommands() binds the commands essential to start the game to the global object, so that they can be invoked by the player in the console without needing to type the invocation operator \"()\" after the name.\n    bindInitialCommands() {\n        var _a;\n        // enable \"start\" and other essential commands\n        const initialCommands = [\n            [this.start, aliasString(\"start\", thesaurus)],\n            [this.resume, cases(\"resume\")],\n            [this.help, aliasString(\"help\", thesaurus)],\n            [this.restore, cases(\"restore\", \"load\")],\n            [this.quit, cases(\"quit\", \"restart\")],\n            [this.save, cases(\"save\")],\n            [this.saveSlot, \"_0\"],\n            [this.saveSlot, \"_1\"],\n            [this.saveSlot, \"_2\"],\n            [this.saveSlot, \"_3\"],\n            [this.saveSlot, \"_4\"],\n            [this.saveSlot, \"_5\"],\n            [this.saveSlot, \"_6\"],\n            [this.saveSlot, \"_7\"],\n            [this.saveSlot, \"_8\"],\n            [this.saveSlot, \"_9\"],\n            [this.pref, cases(\"font\")],\n            [this.pref, cases(\"color\")],\n            [this.pref, cases(\"size\")],\n            [this.yes, cases(\"yes\") + \",y,Y\"],\n        ];\n        (_a = this.commandBinder) === null || _a === void 0 ? void 0 : _a.bindCommands(initialCommands);\n    }\n    // initializeNewGame() is called when the game is started, or when the player dies and the game is restarted\n    initializeNewGame() {\n        var _a;\n        this.resetGame();\n        this.maps = maps;\n        this.descriptions = descriptions;\n        this.items = deepClone(initItemsModule(this));\n        this.commandList = initCommandModule(this);\n        this.commands = this.getCommandsObject(this.commandList);\n        (_a = this.commandBinder) === null || _a === void 0 ? void 0 : _a.bindCommands(this.commandList);\n        this.mapKey = initMapKeyModule(this);\n        // fill inventory with starting items\n        this.addToInventory([\"no_tea\", \"me\"]);\n    }\n    resetGame() {\n        this.state = deepClone(this.initialState);\n        this.state.dogName = randomDogName();\n        removeStorage(\"history\");\n        this.state.gameOver = false;\n    }\n    // getCommandsObject() takes an array of CommandAliases and returns an object containing the command names as keys and the interpreter functions as values\n    getCommandsObject(commandList) {\n        return commandList.reduce((commandMap, commandEntry) => {\n            const [interpreterFunction, aliases] = commandEntry;\n            const [commandName] = aliases.split(\",\");\n            commandMap[commandName.trim()] = interpreterFunction.bind(this);\n            return commandMap;\n        }, {});\n    }\n    /**\n     * =====================\n     * Game state methods\n     * =====================\n     */\n    addToHistory(commandName) {\n        this.state.history.push(commandName);\n        setStorage(\"history\", this.state.history);\n    }\n    addToInventory(itemArray) {\n        // add one of more items to player inventory\n        itemArray.forEach((item) => {\n            if (typeof item === \"string\") {\n                // accepts a string argument for a single item\n                this.state.inventory.push(this.items[`_${item}`]);\n            }\n            else {\n                this.state.inventory.push(item); // accepts an array for multiple items\n            }\n        });\n    }\n    removeFromInventory(item) {\n        // remove item from player inventory\n        const filtered = this.state.inventory.filter((invItem) => {\n            if (typeof item === \"string\") {\n                return invItem.name !== item;\n            }\n            return invItem.name !== item.name;\n        });\n        this.state.inventory = filtered;\n    }\n    // Returns the history of the unfinished game, if it exists, as an array of strings (each string is a command)\n    unfinishedGame() {\n        return getStorage(\"history\");\n    }\n    // replayHistory() takes an array of commands and replays them in order, restoring the game state to the point at which the array was generated\n    replayHistory(commandList) {\n        // Used to load saved games\n        this.state.restoreMode = false;\n        this.log.groupCollapsed(\"Game loading...\"); // This conveniently hides all of the console output that is generated when the history is replayed, by nesting it in a group that will be displayed collapsed by default\n        commandList.forEach((command) => {\n            // replay each command in order\n            Function(`${command}`)(); // execute the command\n        });\n        this.log.groupEnd(\"Game loaded.\"); // text displayed in place of collapsed group\n    }\n    fromWhichEnv(itemName) {\n        const itemsInEnvironment = this.state.combinedEnv.map((item) => item.name);\n        if (!itemsInEnvironment.includes(itemName)) {\n            return false;\n        }\n        const envEntries = Object.entries(this.state.env);\n        const theEnv = envEntries.reduce((env, entry) => {\n            const names = entry[1].length ? entry[1].map((item) => item.name) : [];\n            if (names.includes(itemName)) {\n                env = entry[0];\n            }\n            return env;\n        }, false);\n        // return theEnv || \"containedEnv\";\n        return theEnv;\n    }\n    // given the name of an item, returns the object from the environment\n    inEnvironment(itemName) {\n        if (itemName === \"all\") {\n            return this.items._all;\n        }\n        const whichEnv = this.fromWhichEnv(itemName);\n        const objectFromEnvironment = whichEnv\n            ? this.state.env[whichEnv].filter((item) => item.name === itemName)[0]\n            : false;\n        return objectFromEnvironment;\n    }\n    // returns an object from the inventory, or the entire inventory\n    inInventory(itemName) {\n        if (itemName === \"all\") {\n            return this.items._all;\n        }\n        const [objectFromInventory] = this.state.inventory.filter((item) => item.name === itemName);\n        return objectFromInventory;\n    }\n    /**\n     * =====================\n     * Game output methods\n     * =====================\n     */\n    displayText(text, value) {\n        if (typeof text === \"function\") {\n            const result = text(this, value);\n            if (typeof result === \"string\") {\n                this.displayText(result);\n            }\n        }\n        else if (Array.isArray(text)) {\n            text.forEach((line) => this.displayText(line));\n        }\n        else if (text) {\n            this.log.p(text);\n        }\n    }\n    // Returns a string containing the name of the current room, and the current turn number\n    currentHeader(columnWidth = window.innerWidth) {\n        const roomName = this.state.currentMapCell.name;\n        const turn = `Turn : ${this.state.turn}`;\n        const gapSize = columnWidth / 12 - roomName.length - turn.length;\n        const gap = \" \".repeat(gapSize);\n        return `\\n${roomName}${gap}${turn}\\n`;\n    }\n    // describeSurroundings puts together various parts of game description, and outputs it as a single string\n    describeSurroundings() {\n        const description = this.state.currentMapCell.description;\n        const itemStr = this.itemsInEnvironment()\n            ? `You see ${this.itemsInEnvironment()} here.`\n            : \"\";\n        const nestedItemStr = this.nestedItemString();\n        const moveOptions = `You can go ${this.movementOptions()}.`;\n        this.log.header(this.currentHeader());\n        this.log.p(description + \"\\n\" + moveOptions + \"\\n\" + itemStr + \"\\n\" + nestedItemStr);\n    }\n    // returns a list of items available in the current environment, as a formatted string\n    itemsInEnvironment() {\n        const env = this.state.currentMapCell.hideSecrets\n            ? this.state.env.visibleEnv\n            : [...this.state.env.visibleEnv, ...this.state.env.hiddenEnv];\n        const listedItems = env.filter((item) => item.listed);\n        return (listedItems.length &&\n            formatList(listedItems.map((item) => `${item.article} ${item.name}`)));\n    }\n    // returns a list of items available in the environment that are nested inside other objects, as a formatted string\n    nestedItemString() {\n        const openContainers = this.state.currentMapCell.openContainers;\n        const containedItems = openContainers.map((obj) => {\n            const name = `${obj.article} ${obj.name}`; // the name of the container\n            const objectNames = obj.contents.map((item) => `${item.article} ${item.name}`); // array of names of the objects inside the container (with articles)\n            return [name, objectNames.length ? formatList(objectNames) : void 0];\n        });\n        const containedString = containedItems.map((container) => {\n            return container[1]\n                ? `There is ${container[0]}, containing ${container[1]}.`\n                : \"\";\n        });\n        return containedString.join(\"\\n\");\n    }\n    formatList(list) {\n        return formatList(list);\n    }\n    possibleMoves(z, y, x) {\n        // Returns an array of directions (as strings) that player can move in from present location.\n        const n = this.maps[z][y - 1] !== undefined && this.maps[z][y - 1][x] !== \"*\"\n            ? \"north\"\n            : false; // will equal the string \"north\" if it is possible to move one cell north, otherwise false\n        const s = this.maps[z][y + 1] !== undefined && this.maps[z][y + 1][x] !== \"*\"\n            ? \"south\"\n            : false;\n        const e = this.maps[z][y][x + 1] !== undefined && this.maps[z][y][x + 1] !== \"*\"\n            ? \"east\"\n            : false;\n        const w = this.maps[z][y][x - 1] !== undefined && this.maps[z][y][x - 1] !== \"*\"\n            ? \"west\"\n            : false;\n        const u = this.maps[z + 1] !== undefined && this.maps[z + 1][y][x] !== \"*\"\n            ? \"up\"\n            : false;\n        const d = this.maps[z - 1] !== undefined && this.maps[z - 1][y][x] !== \"*\"\n            ? \"down\"\n            : false;\n        let options = [n, s, e, w, u, d];\n        let result = options.filter((dir) => dir);\n        return result;\n    }\n    // Applies formatList() utility function to the result of possibleMoves() function to return a formatted string listing the possible directions of player movement.\n    movementOptions() {\n        return formatList(this.possibleMoves(this.state.position.z, this.state.position.y, this.state.position.x), true);\n    }\n    variableWidthDivider(width = window.innerWidth) {\n        return ` `.repeat(width / 8);\n    }\n    // Returns a list of saved games, as an array of strings (each string is a slot number)\n    getSavedGames() {\n        const keys = Object.keys(getStorage());\n        const saves = keys.filter((key) => {\n            return key.includes(\"ConsoleGame.save\");\n        });\n        const slotList = saves.map((save) => {\n            return save.slice(-2);\n        });\n        return slotList;\n    }\n    // intro() is called at the beginning of the game\n    intro() {\n        // Greeting to be displayed at the beginning of the game\n        this.displayText(descriptions.intro);\n    }\n    // captured() is called when the player is captured when trying to escape\n    captured() {\n        this.displayText(descriptions.captured[0]);\n        this.state.position = this.state.startPosition;\n        this.state.turn += 3;\n        for (let i = 0; i < 3; i++) {\n            this.commands.wait;\n        }\n        this.items._door.closed = true;\n        this.items._door.locked = true;\n        this.mapKey[this.items._door.lockedTarget].locked = true;\n        this.mapKey[this.items._door.closedTarget].closed = true;\n        this.displayText(descriptions.captured[1]);\n    }\n    // winner() is called when the player wins\n    winner(text) {\n        if (text) {\n            this.displayText(text);\n        }\n        this.displayText(descriptions.winner, text);\n        this.quit();\n    }\n    // dead() is called when the player dies\n    dead(text) {\n        this.displayText(descriptions.dead, text);\n        this.quit();\n    }\n    getFloorMap(crop = true) {\n        const currentPosition = this.state.position;\n        const floorMap = this.maps[currentPosition.z].map((row) => {\n            return row.map((cell) => (cell === \"*\" ? \"⬛️\" : \"🌫\"));\n        });\n        floorMap[currentPosition.y].splice(currentPosition.x, 1, \"⭐️\");\n        return crop ? cropFloorMap(floorMap) : floorMap;\n    }\n    // displayHTMLMap() displays the map in the browser window\n    displayHTMLMap(map) {\n        const contentDiv = document.getElementById(\"console-game-content\");\n        if (contentDiv) {\n            contentDiv.innerHTML = \"\";\n            contentDiv.setAttribute(\"style\", \"width:100vw;background-color:inherit;color:inherit;position:relative;display:flex;flex-direction:column;justify-content:center;align-content:center;\");\n            const mapDiv = document.createElement(\"div\");\n            mapDiv.setAttribute(\"style\", \"width:100vw;height:100vh;position:absolute;top:0;left:0;overflow:auto;\");\n            const mapTable = document.createElement(\"table\");\n            mapTable.setAttribute(\"style\", \"width:100vw;height:100vh;position:absolute;top:0;left:0;overflow:auto;border:none;\");\n            map.forEach((row) => {\n                const mapRow = document.createElement(\"tr\");\n                mapRow.setAttribute(\"style\", \"border:none;\");\n                row.forEach((cell) => {\n                    const mapCell = document.createElement(\"td\");\n                    if (cell === \"⭐️\") {\n                        mapCell.innerHTML = cell;\n                    }\n                    // mapCell.innerHTML = cell;\n                    mapCell.setAttribute(\"style\", `width:1em;height:1em;font-size:1em;text-align:center;vertical-align:middle;${cell === \"⬛️\"\n                        ? \"background-color:black;border:none;\"\n                        : \"background-color:white;\"}`);\n                    mapRow.appendChild(mapCell);\n                });\n                mapTable.appendChild(mapRow);\n            });\n            mapDiv.appendChild(mapTable);\n            contentDiv.appendChild(mapDiv);\n        }\n    }\n    // displayItem() displays a gallery item in the browser window\n    displayItem(galleryItem = {\n        title: \"untitled\",\n        artist: \"unknown\",\n        info: null,\n        source: \"\",\n        dimensions: null,\n        width: null,\n        height: null,\n    }) {\n        var _a;\n        const contentDiv = document.getElementById(\"console-game-content\");\n        if (contentDiv) {\n            (_a = this.turnDaemon) === null || _a === void 0 ? void 0 : _a.removeTimer(\"map\");\n            contentDiv.innerHTML = \"\";\n            contentDiv.setAttribute(\"style\", \"width:100vw;background-color:inherit;color:inherit;position:relative;display:flex;flex-direction:column;justify-content:center;align-content:center;\");\n            const iFrame = document.createElement(\"iframe\");\n            iFrame.src = galleryItem.source;\n            // iFrame.playsinline = true;\n            // iFrame.autoplay = true;\n            // iFrame.muted = true;\n            iFrame.setAttribute(\"style\", `width:${galleryItem.width ? galleryItem.width : \"min(38vw,720px)\"};height:${galleryItem.height ? galleryItem.height : \"min(25vw,480px)\"};margin:auto`);\n            const p = document.createElement(\"p\");\n            const title = document.createElement(\"h2\");\n            title.setAttribute(\"style\", \"color:inherit;\");\n            const artist = document.createElement(\"h2\");\n            artist.setAttribute(\"style\", \"color:inherit;\");\n            title.innerHTML = `Title: ${galleryItem.title}`;\n            artist.innerHTML = `Artist: ${galleryItem.artist}`;\n            p.appendChild(title);\n            p.appendChild(artist);\n            contentDiv.appendChild(iFrame);\n            contentDiv.appendChild(p);\n            if (galleryItem.info) {\n                const info = document.createElement(\"p\");\n                info.innerHTML = galleryItem.info;\n                info.setAttribute(\"style\", \"color:inherit;font-style:italic;font-size:1em;padding-bottom:2em;\");\n                contentDiv.appendChild(info);\n            }\n        }\n        // window.scrollTo(0, 10000);\n    }\n    again() {\n        const lastCommand = this.state.history[this.state.history.length - 1];\n        const itemNames = Object.keys(this.items).map((key) => key.slice(1));\n        if (itemNames.includes(lastCommand)) {\n            const pendingActionFn = this.commands[this.state.pendingAction];\n            // const [pendingActionFn] = this.commands.filter(\n            //   (entry) => entry[1].split(\",\")[0] === this.state.pendingAction\n            // )[0];\n            pendingActionFn.call(this, this.state.pendingAction);\n        }\n        const lastCommandFn = this.commands[lastCommand];\n        lastCommandFn.call(this, lastCommand);\n    }\n    help() {\n        this.displayText(descriptions.help);\n    }\n    // start() initializes a new game, or re-describes the surroundings if the game is already in progress\n    start() {\n        const { turn, gameOver } = this.state;\n        if (!turn || gameOver) {\n            this.initializeNewGame();\n            this.displayText(this.descriptions.preface);\n        }\n        this.describeSurroundings();\n    }\n    resume() {\n        const unfinishedGame = this.unfinishedGame();\n        this.state.prefMode = false;\n        if (unfinishedGame === null || unfinishedGame === void 0 ? void 0 : unfinishedGame.length) {\n            this.resetGame();\n            this.initializeNewGame();\n            this.replayHistory(unfinishedGame);\n            this.describeSurroundings();\n        }\n        else if (this.state.turn) {\n            this.describeSurroundings();\n        }\n        else {\n            this.start();\n        }\n    }\n    restore(command) {\n        const slotList = this.getSavedGames();\n        if (slotList.length > 0) {\n            this.displayText(this.descriptions.restore, slotList);\n            this.state.restoreMode = true;\n            this.state.saveMode = false;\n            this.state.pendingAction = command;\n        }\n        else {\n            return this.log.invalid(\"No saved games found.\");\n        }\n    }\n    quit() {\n        this.commands.score();\n        removeStorage(\"history\");\n        this.state.gameOver = true;\n        this.displayText(this.descriptions.gameOver);\n    }\n    save(command) {\n        this.state.saveMode = true;\n        this.state.restoreMode = false;\n        this.state.pendingAction = command;\n        this.displayText(this.descriptions.save);\n    }\n    saveSlot(slotNumber) {\n        if (this.state.saveMode) {\n            try {\n                return this.saveGame(slotNumber);\n            }\n            catch (err) {\n                this.log.invalid(`Save to slot ${slotNumber} failed.`);\n                this.log.error(err);\n            }\n        }\n        else if (this.state.restoreMode) {\n            try {\n                this.restoreGame(slotNumber);\n                this.state.restoreMode = false;\n            }\n            catch (err) {\n                this.log.invalid(`Restore from slot ${slotNumber} failed.`);\n                return this.log.error(err);\n            }\n        }\n        else {\n            this.log.invalid(\"Operation failed.\");\n        }\n    }\n    pref(whichPref) {\n        this.state.prefMode = true;\n        this.state.pendingAction = whichPref;\n        this.log.codeInline([\n            `To set the value of ${whichPref}, you must type an underscore `,\n            `_`,\n            `, followed by the value enclosed in backticks `,\n            `\\``,\n            `.`,\n        ]);\n        this.log.codeInline([`For example: `, `_\\`value\\``]);\n    }\n    yes() {\n        if (!this.state.confirmMode) {\n            this.log.p(\"nope.\");\n        }\n        else {\n            this.state.confirmMode = false;\n            if (this.confirmationCallback) {\n                return this.confirmationCallback();\n            }\n        }\n    }\n    // saveGame() saves the current game state to local storage\n    saveGame(slot, confirmOverwrite = false) {\n        const slotName = `save.${slot}`;\n        if (getStorage(slotName) && !confirmOverwrite) {\n            // if the slot is already in use, ask for confirmation\n            this.log.invalid(\"That save slot is already in use.\");\n            this.log.codeInline([\n                `type `,\n                `yes `,\n                `to overwrite slot ${slot} with current game data.`,\n            ]);\n            this.state.confirmMode = true;\n            this.confirmationCallback = () => this.saveGame(slot, true);\n        }\n        else {\n            // otherwise, save the game\n            this.state.saveMode = false;\n            this.state.confirmMode = false;\n            try {\n                setStorage(slotName, this.state.history);\n                this.log.info(`Game saved to slot ${slot}.`);\n                this.describeSurroundings();\n            }\n            catch (err) {\n                this.log.invalid(`Save to slot ${slot} failed.`);\n                this.log.error(err);\n            }\n        }\n    }\n    // restoreGame() restores a saved game from local storage, given a slot number, and replays the game history\n    restoreGame(slotName) {\n        this.state.restoreMode = false;\n        const saveData = getStorage(`save.${slotName}`);\n        this.initializeNewGame();\n        this.replayHistory(saveData);\n        this.describeSurroundings();\n    }\n    solveCode(value) {\n        // solve code\n        value = String(value);\n        this.state.solveMode = false;\n        const puzzles = this.state.combinedEnv.filter((item) => item.solution);\n        console.log(\"puzzles\", puzzles);\n        if (puzzles.length) {\n            const solved = puzzles.filter((puzzle) => puzzle.solution === value);\n            if (solved.length === 0) {\n                puzzles.forEach((unsolved) => unsolved.incorrectGuess && unsolved.incorrectGuess());\n            }\n            else {\n                solved.forEach((pzl) => pzl.correctGuess && pzl.correctGuess());\n            }\n        }\n    }\n    // setPreference() is used to set a preference (font, size, color) that will be applied when the game is reloaded\n    setPreference(value) {\n        // set preference\n        this.log.info(`Value for ${this.state.pendingAction} will be set to ${value}`);\n        setStorage(`prefs.${this.state.pendingAction}`, value);\n        setStorage(\"prefMode\", \"true\");\n        this.log.info(\"Reload the page to apply the new preference.\");\n    }\n    // setValue() is used to set a value in the game state, either by solving a puzzle, or by setting a preference\n    setValue(value) {\n        if (this.state.solveMode) {\n            // setValue is not bound to turnDaemon, so we need to call addToHistory() manually, but only if we're in solveMode\n            this.addToHistory(`_(\"${value}\")`);\n            this.solveCode(value);\n        }\n        else if (this.state.prefMode) {\n            this.setPreference(value);\n        }\n        else {\n            this.log.invalid(\"setValue _() called out of context.\");\n        }\n        return this.variableWidthDivider();\n    }\n    // toggleVerbosity() is used to toggle the verbosity of the game's output. If verbose mode is on, then describeSurroundings() will be called every on every turn, not just when the player moves.\n    toggleVerbosity() {\n        if (this.state.verbose) {\n            this.state.verbose = false;\n            this.log.p(\"Verbose mode off.\");\n        }\n        else {\n            this.state.verbose = true;\n            this.log.p(\"Maximum verbosity.\");\n        }\n    }\n}\n//# sourceMappingURL=Game.js.map","import { pStyle } from \"./utils/prefs\";\nimport thesaurus from \"./utils/thesaurus\";\nimport maps from \"./maps/maps\";\nimport { cases, formatList, aliasString } from \"./utils/helpers\";\n// Command functions\nconst Commands = function (game) {\n    // Change player's location on the map, given a direction\n    const _movePlayer = (direction) => {\n        game.state.objectMode = false;\n        let newPosition = {\n            x: game.state.position.x,\n            y: game.state.position.y,\n            z: game.state.position.z,\n        };\n        switch (direction) {\n            case \"north\":\n                newPosition.y = newPosition.y - 1;\n                break;\n            case \"south\":\n                newPosition.y = newPosition.y + 1;\n                break;\n            case \"east\":\n                newPosition.x = newPosition.x + 1;\n                break;\n            case \"west\":\n                newPosition.x = newPosition.x - 1;\n                break;\n            case \"up\":\n                newPosition.z = newPosition.z + 1;\n                break;\n            case \"down\":\n                newPosition.z = newPosition.z - 1;\n                break;\n            default:\n                break;\n        }\n        const newCell = maps[newPosition.z][newPosition.y][newPosition.x];\n        // Exit function if movement in given direction is not possible due to map boundary\n        if (newCell === \"*\") {\n            game.log.p(\"You can't go that direction.\");\n            game.state.abortMode = true; // don't count failed move as a turn; don't increment timers\n            return;\n        }\n        // Display message and exit function if path to next space is blocked by a locked or closed door or analagous item\n        if (game.mapKey[newCell].locked || game.mapKey[newCell].closed) {\n            game.log.p(\"The way is blocked.\");\n            game.log.p(game.mapKey[newCell].lockText &&\n                (game.mapKey[newCell].locked || game.mapKey[newCell].closed)\n                ? game.mapKey[newCell].lockText\n                : \"\");\n            return;\n        }\n        // If movement in direction is possible, update player position\n        game.log.p(`You walk ${direction}...`);\n        game.state.position = {\n            x: newPosition.x,\n            y: newPosition.y,\n            z: newPosition.z,\n        };\n        // End by describing new environment after move\n        return game.describeSurroundings();\n    };\n    // Describe environment and movement options in current location\n    const _look = (command) => {\n        return game.describeSurroundings();\n    };\n    const _smell = (command) => {\n        game.log.p(game.state.currentMapCell.smell);\n        return;\n    };\n    const _listen = (command) => {\n        game.log.p(game.state.currentMapCell.sound);\n        return;\n    };\n    // Handles commands that require an object. Sets pendingAction to the present command, and objectMode so that next command is interpreted as the object of the pending command.\n    const _act_upon = (command) => {\n        game.state.objectMode = true;\n        game.state.pendingAction = command;\n        game.log.p(`What would you like to ${command}?`);\n    };\n    // _none function is bound to commands that should do nothing at all\n    const _none = () => { }; // do nothing\n    const _wait = () => {\n        game.log.p(\"Time passes...\");\n    };\n    const _go = () => {\n        game.log.p(\"Which direction do you want to go?\");\n    };\n    // Displays items in the player's inventory.\n    const _inventory = (command) => {\n        let items = [], itemsPlusArticles = [];\n        game.state.inventory.forEach((item) => {\n            if (item.listed) {\n                items.push(item.name);\n                const itemWithArticle = item.article\n                    ? `${item.article} ${item.name}`\n                    : item.name;\n                itemsPlusArticles.push(itemWithArticle);\n            }\n        });\n        let segments = `You are carrying ${formatList(itemsPlusArticles)}`.split(\" \");\n        let itemStyle = `font-size:120%;color:cyan;font-style:italic;`;\n        let styles = segments.map((word) => {\n            let style = pStyle;\n            items.map((thing) => {\n                if (word.includes(thing)) {\n                    style = itemStyle;\n                }\n            });\n            return style;\n        });\n        segments = segments.map((word, i) => {\n            return i === segments.length - 1 ? `${word}.` : `${word} `;\n        });\n        return game.log.inline(segments, styles);\n    };\n    // Displays inventory as a table.\n    const _inventoryTable = (command) => {\n        const table = game.state.inventory.map((item) => {\n            const { name, description } = item;\n            return { name, description };\n        });\n        return game.log.table(table, [\"name\", \"description\"]);\n    };\n    // Handles commands that are item names.\n    const _items = (itemName) => {\n        // Exit function with error message if previous command does not require an object\n        if (!game.state.objectMode && itemName !== \"maps\") {\n            game.log.invalid(\"Invalid command.\");\n            return;\n        }\n        // Exit function with error message if item is not available in player inventory or current location.\n        const item = game.inEnvironment(itemName) || game.inInventory(itemName);\n        if (!item) {\n            game.state.objectMode = false;\n            game.log.p(`The ${itemName} is unavailable.`);\n            return;\n        }\n        const action = game.state.pendingAction;\n        // invoke the item's method that corresponds to the selected action\n        item[action]();\n    };\n    const _yell = () => {\n        game.log.scream(\"Aaaarrgh!!!!\");\n    };\n    const _verbose = () => {\n        if (game.state.verbose) {\n            game.state.verbose = false;\n            game.log.p(\"Verbose mode off.\");\n            return;\n        }\n        game.state.verbose = true;\n        game.log.p(\"Maximum verbosity.\");\n    };\n    const _score = () => {\n        game.log.p(`Your score is ${game.state.score} in ${game.state.turn} turns.`);\n    };\n    const _commands = () => {\n        const commandAliases = game.commandList.map(([_, aliases]) => aliases);\n        const commandTable = commandAliases.reduce((map, aliases) => {\n            const [commandName, ...aliasList] = aliases.split(\",\");\n            map[commandName] = aliasList.join(\", \");\n            return map;\n        }, {});\n        game.log.table(commandTable);\n    };\n    const _again = () => {\n        game.again();\n    };\n    const _poof = () => {\n        var _a;\n        const body = document.querySelector(\"body\");\n        (_a = body === null || body === void 0 ? void 0 : body.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(body);\n        game.log.papyracy(\">poof<\");\n    };\n    // Commands and their aliases\n    const commandAliases = [\n        // Move\n        [_movePlayer, cases(\"north\") + \",n,N\"],\n        [_movePlayer, cases(\"south\") + \",s,S\"],\n        [_movePlayer, cases(\"east\") + \",e,E\"],\n        [_movePlayer, cases(\"west\") + \",w,W\"],\n        [_movePlayer, cases(\"up\") + \",u,U\"],\n        [_movePlayer, cases(\"down\") + \",d,D\"],\n        // Direct Actions\n        [_go, aliasString(\"go\", thesaurus)],\n        [_inventory, aliasString(\"inventory\", thesaurus) + \",i,I\"],\n        [_listen, aliasString(\"listen\", thesaurus)],\n        [_look, aliasString(\"look\", thesaurus) + \",l,L\"],\n        [_smell, aliasString(\"smell\", thesaurus)],\n        [_wait, aliasString(\"wait\", thesaurus) + \",z,Z,zzz,ZZZ,Zzz\"],\n        [_yell, aliasString(\"yell\", thesaurus)],\n        [_again, aliasString(\"again\", thesaurus) + \",g,G\"],\n        // Item methods\n        [_act_upon, aliasString(\"burn\", thesaurus)],\n        [_act_upon, aliasString(\"climb\", thesaurus)],\n        [_act_upon, aliasString(\"close\", thesaurus)],\n        [_act_upon, aliasString(\"contemplate\", thesaurus)],\n        [_act_upon, aliasString(\"drink\", thesaurus)],\n        [_act_upon, aliasString(\"drop\", thesaurus)],\n        [_act_upon, aliasString(\"eat\", thesaurus)],\n        [_act_upon, aliasString(\"examine\", thesaurus) + \",x,X\"],\n        [_act_upon, aliasString(\"extinguish\", thesaurus)],\n        [_act_upon, aliasString(\"flush\", thesaurus)],\n        [_act_upon, aliasString(\"light\", thesaurus)],\n        [_act_upon, aliasString(\"lock\", thesaurus)],\n        [_act_upon, aliasString(\"move\", thesaurus)],\n        [_act_upon, aliasString(\"open\", thesaurus)],\n        [_act_upon, aliasString(\"play\", thesaurus)],\n        [_act_upon, aliasString(\"project\", thesaurus)],\n        [_act_upon, aliasString(\"pull\", thesaurus)],\n        [_act_upon, aliasString(\"read\", thesaurus)],\n        [_act_upon, aliasString(\"rezrov\", thesaurus)],\n        [_act_upon, aliasString(\"frotz\", thesaurus)],\n        [_act_upon, aliasString(\"cast\", thesaurus)],\n        [_act_upon, aliasString(\"rescue\", thesaurus)],\n        [_act_upon, aliasString(\"spray\", thesaurus)],\n        [_act_upon, aliasString(\"take\", thesaurus)],\n        [_act_upon, aliasString(\"turn\", thesaurus)],\n        [_act_upon, aliasString(\"unlock\", thesaurus)],\n        [_act_upon, aliasString(\"use\", thesaurus)],\n        // Misc\n        [_commands, cases(\"commands\") + \",c,C\"],\n        [_inventoryTable, cases(\"inventoryTable\", \"invTable\", \"invt\")],\n        [_verbose, cases(\"verbose\")],\n        [_score, cases(\"score\")],\n        // Other\n        [_poof, cases(\"poof\")],\n        // this command exists as a kludgy fix for a bug that happens if console is in \"eager evaluation\" mode. Starting to type \"glove\" auto-evaluates to \"globalThis\", which for some reason calls _act_upon(\"close\"). This same goes for the keyword \"this\". This command tricks auto-evaluation because it prioritizes suggestions alphabetically.\n        [_none, cases(\"globaa\")],\n        [_none, cases(\"thia\")],\n    ];\n    const itemNames = Object.keys(game.items).map((itemName) => itemName.slice(1));\n    const itemAliases = itemNames.map((itemName) => [\n        _items,\n        aliasString(itemName, thesaurus),\n    ]);\n    const aliases = [...commandAliases, ...itemAliases];\n    return aliases;\n};\nexport default Commands;\n//# sourceMappingURL=commands.js.map","export default function MapCell(game) {\n    // Prototype definition for a single cell on the map grid (usually a room)\n    return {\n        name: \"Nowhere\",\n        locked: false,\n        lockText: \"\",\n        unlockText: \"\",\n        hiddenSecrets: false,\n        get hideSecrets() {\n            const combinedEnv = [...this.visibleEnv, ...game.state.inventory];\n            const lightSource = combinedEnv.some((item) => {\n                return item.lightCount > 0;\n            });\n            if (lightSource) {\n                return false;\n            }\n            return this.hiddenSecrets;\n        },\n        set hideSecrets(trueOrFalse) {\n            this.hiddenSecrets = trueOrFalse;\n        },\n        description: \"You find yourself in a non-descript, unremarkable, non-place. Nothing is happening, nor is anything of interest likely to happen here in the future.\",\n        smell: \"Your nose is unable to detect anything unusual, beyond the smell of age and decay that permeates the entirety of the decrepit building.\",\n        sound: \"The silence is broken only by the faint sound of the wind outside, and the occasional creak of sagging floorboards underfoot.\",\n        hiddenEnv: [],\n        visibleEnv: [],\n        get env() {\n            // accessor property returns an array containing the names (as strings) of the items in present environment\n            return {\n                visibleEnv: this.visibleEnv,\n                containedEnv: this.containedEnv,\n                hiddenEnv: this.hideSecrets ? [] : this.hiddenEnv,\n            };\n        },\n        // returns any items in the environment that contain other items and are open, as an array of the item objects\n        get openContainers() {\n            const itemsInEnv = this.hideSecrets\n                ? this.visibleEnv\n                : [...this.visibleEnv, ...this.hiddenEnv];\n            const itemsWithContainers = itemsInEnv.filter((item) => item.contents && item.contents.length > 0);\n            const openContainerItems = itemsWithContainers.filter((containerItem) => !containerItem.closed);\n            return openContainerItems;\n        },\n        // returns the items available in the environment that are nested inside other objects\n        get containedEnv() {\n            const containedItems = this.openContainers.length > 0\n                ? this.openContainers.map((item) => {\n                    return item.contents || [];\n                })\n                : [];\n            return containedItems.flat();\n        },\n        removeFromEnv: function (item) {\n            const itemName = typeof item === \"string\" ? item : item.name;\n            const envName = game.fromWhichEnv(itemName);\n            if (envName === \"containedEnv\") {\n                this.removeFromContainer(itemName);\n            }\n            else if (!envName) {\n                game.log.error(`Item ${itemName} not found in any environment`);\n            }\n            else {\n                const thisEnv = this[envName];\n                const filteredEnv = thisEnv.filter((it) => it.name !== itemName);\n                this[envName] = filteredEnv;\n            }\n        },\n        removeFromContainer: function (item) {\n            var _a;\n            // TODO: make sure this takes into account nested containers and items in inventory\n            const itemName = typeof item === \"string\" ? item : item.name;\n            const [container] = this.openContainers.filter((thing) => (thing.contents || []).map((it) => it.name).includes(itemName));\n            if (!container) {\n                game.log.error(`Item ${itemName} not found in any container`);\n            }\n            if (!game.inEnvironment(container.name)) {\n                game.log.error(`Container ${container.name} not in environment`);\n            }\n            else {\n                const filteredContainer = (_a = container.contents) === null || _a === void 0 ? void 0 : _a.filter((item) => {\n                    return item.name !== itemName;\n                });\n                container.contents = filteredContainer;\n            }\n        },\n        addToEnv: function (itemName) {\n            const itemObj = game.items[`_${itemName}`];\n            return this.visibleEnv.push(itemObj);\n        },\n    };\n}\n//# sourceMappingURL=MapCell.js.map","import Game from \"./Game\";\nimport storage from \"./utils/storage\";\nwindow.CONSOLE_GAME_DEBUG = true;\n// Wait for page to load\nwindow.onload = () => {\n    // Create game object.\n    const game = new Game();\n    window.game = game;\n    const prefMode = storage.getStorage(\"prefMode\");\n    if (prefMode) { // if prefMode is set, the user has just changed a preference, and reloaded the page so it would take effect. Resume the game from its previous state.\n        storage.removeStorage(\"prefMode\");\n        game.resume();\n    }\n    else {\n        return game.intro();\n    }\n};\nwindow.scroll(0, 0);\n//# sourceMappingURL=index.js.map"],"names":["storage","namespace","storageMethods","getStorage","key","_a","localStorage","stringifiedData","getItem","JSON","parse","err","setStorage","data","merge","newState","previousState","Object","assign","setItem","stringify","removeStorage","removeItem","initStorage","eval2","eval","getRandomInt","min","max","Math","floor","random","cases","wordArgs","lc","map","word","toLowerCase","charAt","toUpperCase","slice","length","join","aliasString","thesaurus","optionalString","variations","synonym","deepClone","obj","unfreeze","fnString","String","Array","isArray","item","Date","getTime","RegExp","Map","forEach","value","set","Set","add","clone","create","getPrototypeOf","getOwnPropertyNames","descriptor","getOwnPropertyDescriptor","writable","error","defineProperty","getOwnPropertySymbols","formatList","itemArray","disjunction","conjunction","prefsAreSet","keys","some","indexOf","console","log","primaryFont","textColor","fontSize","pStyle","logStyles","style","logType","h1","intro","cursive","note","warning","papyracy","p","tiny","info","invalid","inventory","title","win","header","groupTitle","codeInlineBaseStyle","codeInlineCodeStyle","getDigiStyle","getScreamStyle","index","fonts","getColors","isGray","foreground","randomRGBGrayValues","randomRGBValues","background","border","randomPadding","r","g","b","maxVariance","randomlyVary","baseValue","maxVary","randomAbsoluteVariance","randomActualVariance","randomCase","message","split","char","rand","randomOutline","color","width","colorString","randomFont","number","_inline","stringSegmentArray","styleArray","stringSegments","segment","_customLog","window","CONSOLE_GAME_DEBUG","debugLog","push","gameOutput","_codeInline","stringOrStringSegmentArray","baseStyle","codeStyle","fill","_digi","spacedText","styles","_map","floorMap","table","row","_scream","splitText","_ransom","text","blankStyle","br","bg","bb","flat","getRansomArray","customConsole","inline","codeInline","digi","scream","custom","ransom","groupCollapsed","groupEnd","styleName","styleDetails","dogNames","bed","booklet","bookshelves","burn","collar","contemplate","cup","disc","drink","drop","eat","examine","extinguish","film","glove","go","grue_repellant","help","lantern","listen","lock","look","maps","matchbook","move","open","painting","phonograph","photo","pull","read","safe","scroll","smell","spray","start","take","toilet","turn","use","wait","yell","allWords","entries","reduce","accum","entry","duplicates","filter","currentIndex","Error","boundary","mapArray","line","itemContents","_glove","_safe","_drawer","_nightstand_drawer","_wardrobe","_dresser_drawer","items","_all","_backdoor","_basement_door","_bathtub","_bed","_booklet","_books","_bookshelves","_chain","_chair","_coffee_table","_collar","_cup","_desk","_disc","_dog","_door","_dresser","_film","_filthy_note","_grue","_grue_repellant","_key","_keypad","_knife","_lantern","_maps","_matchbook","_me","_nightstand","_no_tea","_note","_old_key","_painting","_pedestal","_phonograph","_photo","_projector","_screen","_scroll","_sink","_sofa","_table","_toilet","initItems","game","hydratedItems","itemName","hydrateItems","ItemProto","name","used","weight","description","this","reverseDescription","takeable","openable","flammable","activated","closed","locked","article","listed","solution","points","count","proto","contents","unlockedBy","lockedTarget","closedTarget","containedPart","lightCount","state","objectMode","inInventory","inEnvironment","currentMapCell","removeFromEnv","removeFromInventory","burnDown","call","dead","climb","close","mapKey","correctGuess","incorrectGuess","decrementCounter","score","visibleEnv","flush","frotz","rezrov","addToInventory","takeComponent","realItem","unlock","initItemProto","defaultProto","setPrototypeOf","setPrototypes","itemsWithContents","contentsObj","_itemName","itemToInclude","_itemToInclude","addItemContents","descriptions","preface","introOptions","unfinishedGame","captured","winner","additionalText","gameOver","italicCodeStyle","restore","slotList","exampleSlot","save","doorLock","initialTimers","displayText","timeLimit","lightSources","source","lurk","EXEMPT_COMMANDS","TurnDaemon","constructor","timers","timer","registerTimer","executeCommand","bind","removeTimer","runTimers","commandName","interpreterFunction","globalThis","variableWidthDivider","userInput","includes","addToHistory","abortMode","verbose","describeSurroundings","trace","function","timerFunction","timerToRemove","hasTimer","timerToCheck","RESERVED_WORDS_TO_OVERWRITE","CommandBinder","bindCommandToFunction","bindCommands","commandAliases","daemon","aliasArray","interpretCommand","alias","trim","get","commands","commandEntry","aliases","turnDaemon","gameContext","Game","commandList","confirmationCallback","commandBinder","initialState","solveMode","prefMode","restoreMode","pendingAction","dogName","startPosition","z","y","x","position","history","currentCellCode","env","combinedEnv","values","_","setValue","bindInitialCommands","initialCommands","resume","quit","saveSlot","pref","yes","initializeNewGame","resetGame","initItemsModule","_movePlayer","direction","newPosition","newCell","lockText","_act_upon","command","_none","_items","itemsPlusArticles","itemWithArticle","segments","thing","i","sound","again","commandTable","aliasList","body","document","querySelector","parentNode","removeChild","initCommandModule","getCommandsObject","MapCellProto","unlockText","hiddenSecrets","hideSecrets","trueOrFalse","hiddenEnv","containedEnv","openContainers","containerItem","envName","fromWhichEnv","removeFromContainer","filteredEnv","it","container","filteredContainer","addToEnv","itemObj","MapCell","mapkey","A","a","B","C","des1","des2","D","E","F","G","H","I","J","visibleDescription","hiddenDescription","$","hidden","plural","X","Z","cell","setMapCellPrototypes","subEnvNames","keyName","subEnvName","roomEnv","newEnv","stockDungeon","initMapKeyModule","commandMap","filtered","invItem","replayHistory","Function","whichEnv","objectFromInventory","result","currentHeader","columnWidth","innerWidth","roomName","gapSize","repeat","itemStr","itemsInEnvironment","nestedItemStr","nestedItemString","moveOptions","movementOptions","listedItems","objectNames","list","possibleMoves","undefined","dir","getSavedGames","getFloorMap","crop","currentPosition","splice","top","findIndex","bottom","reverse","lefts","left","rights","reverseIndex","right","cropFloorMap","displayHTMLMap","contentDiv","getElementById","innerHTML","setAttribute","mapDiv","createElement","mapTable","mapRow","mapCell","appendChild","displayItem","galleryItem","artist","dimensions","height","iFrame","src","lastCommand","saveMode","slotNumber","saveGame","restoreGame","whichPref","confirmMode","slot","confirmOverwrite","slotName","saveData","solveCode","puzzles","solved","puzzle","unsolved","pzl","setPreference","toggleVerbosity","onload"],"mappings":"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,OACA,QACA,MACA,SACA,SACA,MACA,QACA,UACA,QACA,SACA,MACA,QACA,SACA,QACA,SACA,SACA,QACA,SACA,OACA,OACA,KACA,OACA,OACA,QACA,OACA,SACA,SACA,SACA,QACA,OACA,QACA,QACA,QACA,QACA,SACA,QACA,SACA,MACA,OACA,MACA,OACA,SACA,OACA,OACA,QACA,SACA,SACA,OACA,QACA,OACA,QACA,SACA,UACA,SACA,UACA,QACA,QACA,SACA,SACA,SACA,OACA,QACA,OACA,UACA,MACA,QACA,QACA,QACA,QACA,QACA,SACA,OACA,SACA,SACA,QACA,OACA,QACA,QACA,OACA,SACA,QACA,SACA,QACA,SACA,OACA,OACA,OACA,OACA,OACA,SACA,SACA,OACA,QACA,MACA,SACA,OACA,QACA,QACA,QACA,MACA,QACA,OACA,SACA,OACA,OACA,OACA,OACA,QACA,QACA,QACA,SACA,QACA,WACA,OACA,OACA,QACA,SACA,QACA,QACA,QACA,QACA,QACA,OACA,QACA,SACA,SACA,SACA,QACA,OACA,SACA,UACA,OACA,UACA,SACA,SACA,SACA,SACA,QACA,QACA,SACA,QACA,QACA,QACA,OACA,SACA,SACA,SACA,OACA,QACA,QACA,OACA,SACA,SACA,QACA,QACA,QACA,SACA,QACA,SACA,SACA,QACA,OACA,OACA,UACA,QACA,QACA,SACA,QACA,UACA,QACA,QACA,QACA,QACA,UCxME7I,EAAY,CACd8I,IAAK,CAAC,WAAY,YAClBC,QAAS,CAAC,UAAW,YAAa,OAAQ,WAC1CC,YAAa,CAAC,YAAa,QAAS,WACpCC,KAAM,CAAC,SAAU,aAAc,YAC/BC,OAAQ,CAAC,aAAc,SACvBC,YAAa,CACT,WACA,WACA,QACA,WACA,YACA,SACA,aACA,OACA,UACA,OACA,YAEJC,IAAK,CAAC,UAAW,UACjBC,KAAM,CAAC,SAAU,QAAS,aAAc,OAAQ,YAAa,UAC7DC,MAAO,CAAC,SAAU,SAAU,SAAU,OAAQ,SAAU,SACxDC,KAAM,CACF,SA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"}